%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Sonny]{fncychap}
\usepackage{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{图}}
\addto\captionsenglish{\renewcommand{\tablename}{表}}
\addto\captionsenglish{\renewcommand{\literalblockname}{列表}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{续上页}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{页}}

\setcounter{tocdepth}{1}



\title{善理对讲SDK Documentation}
\date{2018 年 02 月 13 日}
\release{alpha}
\author{姚红涛}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{发布}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{C Windows集成}
\label{\detokenize{index:c-windows}}\label{\detokenize{index:sdk}}

\section{1 概述}
\label{\detokenize{c_win::doc}}\label{\detokenize{c_win:id1}}\begin{quote}

本文档主要介绍Win-SDK
接口函数（API），主要针对FAE，测试人员和客户使用 。
\end{quote}


\section{2 功能性接口}
\label{\detokenize{c_win:id2}}

\subsection{2.1 初始化接口}
\label{\detokenize{c_win:id3}}\begin{itemize}
\item {} 
程序启动

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}on\PYGZus{}load(void *arg)
参数：arg 配置文件路径
返回：成功 0；失败 \PYGZhy{}1
注意：程序启动时调用此接口，如果调用了echat\PYGZus{}win\PYGZus{}on\PYGZus{}unload， 想再次启动程序，必须调用echat\PYGZus{}win\PYGZus{}on\PYGZus{}load
\end{sphinxVerbatim}

\item {} 
程序退出

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：void echat\PYGZus{}win\PYGZus{}on\PYGZus{}unload()
\end{sphinxVerbatim}

\end{itemize}


\subsection{2 .2 登录配置接口}
\label{\detokenize{c_win:id4}}\begin{itemize}
\item {} 
登录

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}login(const char* account, const char* password, int role)
参数：account  账号
  password 密码
  role  用户角色 普通用户 0 ； 调度员 2
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
使用配置文件中的账号信息登录

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}loginWithSaved()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
注销

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}logout()
返回：0
\end{sphinxVerbatim}

\item {} 
配置文件是否存有账号配置

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：boolean echat\PYGZus{}win\PYGZus{}hasAccount()
返回：有 True；无 False
\end{sphinxVerbatim}

\item {} 
从配置文件获取账号配置信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getSavedAccount(char*account,const char* password,int*role)
参数：account  用于保存账号（必须分配内存）
  password  用于保存密码（必须分配内存）
  role  用于保存角色（必须分配内存）
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
保存账号配置

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}saveAccount(const char* account, const char* password, int role)
参数：account  账号
  password 密码
  role  用户角色 普通用户 0 ； 调度员 2
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
清空账号配置

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}clearAccount()
返回：0
\end{sphinxVerbatim}

\item {} 
获取登录状态

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：ECHAT\PYGZus{}ONLINE\PYGZus{}STATUS echat\PYGZus{}win\PYGZus{}getOnlineStatus()
返回：未知 0；不在线 1；登录中  2；在线  3
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.3 对讲接口}
\label{\detokenize{c_win:id5}}\begin{itemize}
\item {} 
开始讲话

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}startSpeak()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
停止讲话

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}stopSpeak()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
获取当前用户的讲话状态

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：boolean echat\PYGZus{}win\PYGZus{}isSpeaking()
返回：正在讲话 True；其它 False
\end{sphinxVerbatim}

\item {} 
是否有人在讲话

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：boolean echat\PYGZus{}win\PYGZus{}isListening()
返回：有人讲话 True；其它 False
\end{sphinxVerbatim}

\item {} 
获取正在播放声音的人的user信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getPlayingSoundUser(win\PYGZus{}user\PYGZus{}t* user)
参数：user  用于存放用户信息（必须分配内存）
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
获取正在讲话的人的个数

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：size\PYGZus{}t echat\PYGZus{}win\PYGZus{}getSpeakingUsersSize()
返回：正在讲话人的个数
注意：监听时使用
\end{sphinxVerbatim}

\item {} 
获取正在讲话的人的user信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getSpeakingUsers(win\PYGZus{}user\PYGZus{}t* user, size\PYGZus{}t size)
参数：user  用于存放用户信息（必须分配内存）
  size  用户个数
返回：成功  0；失败 \PYGZhy{}1；参数错误 \PYGZhy{}3
注意：监听时使用
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.4 群组操作接口}
\label{\detokenize{c_win:id6}}\begin{itemize}
\item {} 
加入群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}joinGroup( gid\PYGZus{}t gid)
参数：gid  群组ID
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
离开当前群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}leaveGroup()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
获取当前群组ID

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：gid\PYGZus{}t echat\PYGZus{}win\PYGZus{}getCurrentGroup()
返回：成功 群组ID；失败 0
\end{sphinxVerbatim}

\item {} 
获取群组的个数

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：size\PYGZus{}t echat\PYGZus{}win\PYGZus{}getGroupSize()
返回：群组个数
\end{sphinxVerbatim}

\item {} 
获取群组列表

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int  echat\PYGZus{}win\PYGZus{}getGroupList(win\PYGZus{}group\PYGZus{}t* group,size\PYGZus{}t size)
参数：group  用于存放群组数据（必须分配内存）
  size  群组的个数
返回：成功  获取群组的个数；错误  \PYGZhy{}1；内存不足  \PYGZhy{}2；参数错误  \PYGZhy{}3
\end{sphinxVerbatim}

\item {} 
通过群组ID获取群组信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getGroupByGid(win\PYGZus{}group\PYGZus{}t* group, gid\PYGZus{}t gid)
参数：group  用于存放群组信息（必须分配内存）
  gid  群组ID
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
建立临时群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}Call(const uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：uids  用户ID列表
  size  用户ID个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.5 用户操作接口}
\label{\detokenize{c_win:id7}}\begin{itemize}
\item {} 
修改用户名

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}changeName(const char* name)
参数：name  新用户名
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
修改密码

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}changePassword(const char* oldpassword,const char* newpassword)
参数：oldpassword  旧密码
  newpassword  新密码
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
获取当前用户ID

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：uid\PYGZus{}t echat\PYGZus{}win\PYGZus{}getUid()
返回：成功 用户ID；失败 0
\end{sphinxVerbatim}

\item {} 
获取当前用户名

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getName(char* name)
参数：name  用于存放用户名（必须分配内存）
返回：0
\end{sphinxVerbatim}

\item {} 
查询用户是否被遥闭

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：boolean echat\PYGZus{}win\PYGZus{}hasAudioEnabled()
返回：遥开 True；遥闭 False
\end{sphinxVerbatim}

\item {} 
通过群组ID获取群组成员个数

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：size\PYGZus{}t echat\PYGZus{}win\PYGZus{}getMemberSize(gid\PYGZus{}t gid)
参数：gid  群组ID
返回：成员个数； 参数错误 \PYGZhy{}2
\end{sphinxVerbatim}

\item {} 
获取群组成员列表

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getMemberList(win\PYGZus{}member\PYGZus{}t* member, size\PYGZus{}t size, gid\PYGZus{}t gid)
参数：member  用于存放成员数据（必须分配内存）
  size  成员的个数
  gid  群组ID
返回：成功  获取成员的个数；错误  \PYGZhy{}1；内存不足  \PYGZhy{}2；参数错误  \PYGZhy{}3
\end{sphinxVerbatim}

\item {} 
通过用户ID获取用户信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getUser(win\PYGZus{}user\PYGZus{}t* user,uid\PYGZus{}t uid)
参数：user  用于存放用户信息（必须分配内存）
  uid  用户ID
返回：成功 获取的用户信息个数；失败 \PYGZhy{}1；参数错误  \PYGZhy{}2
\end{sphinxVerbatim}

\item {} 
通过用户ID列表获取多个用户信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getUsers(win\PYGZus{}user\PYGZus{}t* user, uid\PYGZus{}t* uids, size\PYGZus{}t size)
参数：user  用于存放用户信息（必须分配内存）
  uids  用户ID列表
  size  用户个数
返回：成功 获取的用户信息个数；失败 \PYGZhy{}1；参数错误  \PYGZhy{}2
\end{sphinxVerbatim}

\item {} 
获取所有用户个数

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getAllUserSize()
返回：用户个数
\end{sphinxVerbatim}

\item {} 
获取所有用户ID

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getAllUsersId(uid\PYGZus{}t* uids, size\PYGZus{}t size)
参数：uids  用于存放用户ID列表（必须分配内存）
  size  用户个数
返回：成功  获取的用户信息个数；失败 \PYGZhy{}1；参数错误 \PYGZhy{}2
\end{sphinxVerbatim}

\item {} 
获取当前用户信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getCurrentUser(win\PYGZus{}user\PYGZus{}t* user)
参数：user  用于存放用户列表信息（必须分配内存）
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.6 监听接口}
\label{\detokenize{c_win:id8}}\begin{itemize}
\item {} 
开始监听某个群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}startWatchGroup(gid\PYGZus{}t gid)
参数：gid  群组ID
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
停止监听某个群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}stopWatchGroup(gid\PYGZus{}t gid)
参数：gid  群组ID
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
获取已监听群组信息

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}getWatchGroups(win\PYGZus{}group\PYGZus{}t*watch\PYGZus{}groups,size\PYGZus{}t size)
参数：watch\PYGZus{}groups  存放监听群组的信息（必须分配内存）
  size  群组个数
返回：成功  0；失败 \PYGZhy{}1；参数错误 \PYGZhy{}3
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.7 广播操作接口}
\label{\detokenize{c_win:id9}}\begin{itemize}
\item {} 
发送文字广播

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}broadcast\PYGZus{}send\PYGZus{}text(char* text,uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：text  文字字符串
  uids  发给用户的ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
录制待广播的语音数据

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}broadcast\PYGZus{}start\PYGZus{}record()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
停止录制待广播的语音数据

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}broadcast\PYGZus{}stop\PYGZus{}record()
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
播放已录制的待播放语音数据

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}broadcast\PYGZus{}play\PYGZus{}recordaudio(win\PYGZus{}pfn\PYGZus{}broadcast\PYGZus{}play\PYGZus{}async\PYGZus{}stop pfn)
参数：pfn  发送已录制的语音广播数据
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
发送已录制的语音广播数据

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}broadcast\PYGZus{}send\PYGZus{}recordaudio(uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：uids  发给用户的ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.8 调度操作接口}
\label{\detokenize{c_win:id10}}\begin{itemize}
\item {} 
临时加入组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}temp\PYGZus{}join\PYGZus{}group(gid\PYGZus{}t gid, uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：gid  要加入的群组ID
  uids  用户ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
临时移除组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}temp\PYGZus{}leave\PYGZus{}group(gid\PYGZus{}t gid, uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：gid  要加入群组ID（为0表示移出组）
  uids  用户ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
遥开摇闭

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}audioenable(uid\PYGZus{}t* uids,size\PYGZus{}t size, boolean audioenabled)
参数：uids  用户ID列表
  size  用户个数
  audioenabled  遥开 True  摇闭  False
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
强拉,拉到调度员所在的群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}force\PYGZus{}dispatch(uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：uids  用户ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
强拆

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}takemic(uid\PYGZus{}t* uids,size\PYGZus{}t size)
参数：uids  用户ID列表
  size  用户个数
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\item {} 
开启/关闭定位

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}schedule\PYGZus{}switch\PYGZus{}location(uid\PYGZus{}t* uids, size\PYGZus{}t size, boolean enable, uint32\PYGZus{}t period)
参数：auids  用户ID列表
  size  用户个数
  enable  打开 True  关闭  False
  period  上报速度 （30\PYGZti{}300s）
返回：成功 0；失败 \PYGZhy{}1
\end{sphinxVerbatim}

\end{itemize}


\subsection{2.9 本地录音操作接口}
\label{\detokenize{c_win:id11}}\begin{itemize}
\item {} 
本地录音开关

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}record\PYGZus{}set\PYGZus{}enabled(boolean record\PYGZus{}enabled,char* pathDir)
参数：record\PYGZus{}enabled  打开 True   关闭 False
  pathDir  保存路径，例如：“D:/record\PYGZus{}file”
返回：成功 0；失败 \PYGZhy{}1
注意：录音时自动保存在该路径，生成文件名是：时间+GID+UID.evrc
\end{sphinxVerbatim}

\item {} 
本地录音播放

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}record\PYGZus{}play\PYGZus{}audio(char* path)
参数：path  路径及文件名，例如：“D:/record\PYGZus{}file/时间+GID+UID.evrc”
返回：成功 0；失败 \PYGZhy{}1
注意：播放已录音的文件，需要路径及文件名
\end{sphinxVerbatim}

\end{itemize}


\section{3 消息通知回调接口}
\label{\detokenize{c_win:id12}}\begin{itemize}
\item {} 
设置在线状态回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}online\PYGZus{}status\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}online\PYGZus{}status cb)
参数：cb 在线状态变化时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当前用户上线或下线时触发通知在线状态
\end{sphinxVerbatim}

\item {} 
设置消息通知回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}message\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}message cb)
参数：cb 对外通知消息函数
返回：成功 0；失败 \PYGZhy{}1
注意：暂不可用
\end{sphinxVerbatim}

\item {} 
设置错误消息回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}error\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}error cb)
参数：cb错误消息通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：有操作错误或异常错误触发通知错误信息（见 3 错误信息标识）
\end{sphinxVerbatim}

\item {} 
设置遥开摇闭通知回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}audio\PYGZus{}enabled\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}audio\PYGZus{}enable cb)
参数：cb被遥开、摇闭时回调函数
返回：成功 0；失败 \PYGZhy{}1
注意：当被遥开或摇闭时触发，通知当前状态
\end{sphinxVerbatim}

\item {} 
设置修改用户名回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}change\PYGZus{}name\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}change\PYGZus{}name cb)
参数：cb  用户名修改通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：主动修改用户名时触发，通知结果
\end{sphinxVerbatim}

\item {} 
设置修改密码回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}change\PYGZus{}password\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}change\PYGZus{}password cb)
参数：cb密码修改通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：主动修改用户密码时触发，通知结果
\end{sphinxVerbatim}

\item {} 
设置用户列表回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}memberlist\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}memberlist cb)
参数：cb 通知用户列表函数
返回：成功 0；失败 \PYGZhy{}1
注意：请求用户信息时，用户信息从服务器返回后触发，通知用户信息已更新
\end{sphinxVerbatim}

\item {} 
设置成员改变回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}member\PYGZus{}changed\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}members\PYGZus{}changed cb)
参数：cb 成员改变时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当有成员信息改变时，通知改变结果（进组、离组等）
\end{sphinxVerbatim}

\item {} 
设置用户角色改变回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}roles\PYGZus{}changed\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}members\PYGZus{}changed cb)
参数：cb  用户角色改变时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：暂不可用
\end{sphinxVerbatim}

\item {} 
设置群组列表回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：echat\PYGZus{}win\PYGZus{}set\PYGZus{}grouplist\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}grouplist cb)
参数：cb 通知群组列表时函数
返回：成功 0；失败 \PYGZhy{}1
注意：主动请求群组或群组改变时触发，通知群组列表信息（群组改变：进入群组、调度当前群组、群组列表改变时）
\end{sphinxVerbatim}

\item {} 
设置用户开始讲话回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}user\PYGZus{}start\PYGZus{}speak\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}user\PYGZus{}start\PYGZus{}speak cb)
参数：cb 用户开始讲话时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：其它成员开始讲话时触发，通知群组ID和讲话人ID
\end{sphinxVerbatim}

\item {} 
设置用户停止讲话回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}user\PYGZus{}stop\PYGZus{}speak\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}user\PYGZus{}stop\PYGZus{}speak cb)
参数：cb 用户停止讲话时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：其它成员结束讲话时触发，通知群组ID和讲话人ID
\end{sphinxVerbatim}

\item {} 
设置开始讲话回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}start\PYGZus{}speak\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}speak cb)
参数：cb 开始讲话时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：自己开始讲话时触发，通知（0,0）
\end{sphinxVerbatim}

\item {} 
设置停止讲话回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}stop\PYGZus{}speak\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}stop\PYGZus{}speak cb)
参数：cb 停止讲话时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：自己结束讲话时触发，结束讲话包含：主动结束（通知0，0）、被摘MIC和获取MIC失败（通知群组ID和当前用户ID）等
\end{sphinxVerbatim}

\item {} 
设置当前群组回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}current\PYGZus{}group\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}current\PYGZus{}group cb)
参数：cb 当前群组通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当前群组变化时触发，当前群组变化包含：进组失败（通知0，0）、主动进组和调度进组（通知当前群组ID和0）
\end{sphinxVerbatim}

\item {} 
设置用户改变回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}users\PYGZus{}changed\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}users\PYGZus{}changed cb)
参数：cb 用户信息改变时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当用户信息改变时触发，通知用户的信息，包含：用户角色、上下线、遥开摇闭、定位信息等
\end{sphinxVerbatim}

\item {} 
设置监听群组回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}watchgrouplist\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}watchgrouplist cb)
参数：cb 监听群组时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当设置了监听群组时触发，登录时有默认监听群组或配置监听群组
\end{sphinxVerbatim}

\item {} 
设置开始播放回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}start\PYGZus{}playing\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}playing\PYGZus{}sound cb)
参数：cb 开始播放时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：其它成员开始讲话，自己开始播放音频时触发，通知群组ID和讲话人ID
\end{sphinxVerbatim}

\item {} 
设置停止播放回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}stop\PYGZus{}playing\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}stop\PYGZus{}playing\PYGZus{}sound cb)
参数：cb 停止播放时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当其它成员结束讲话，自己停止播放音频时触发，通知群组ID和讲话人ID
\end{sphinxVerbatim}

\item {} 
设置调度回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}dispatcher\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}dispatcher cb)
参数：cb 调度时通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当有调度（强拉/临时加入组/移除组）时触发，通知被调度的群组ID、用户ID列表
\end{sphinxVerbatim}

\item {} 
设置强拆回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}take\PYGZus{}mic\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}takemic cb)
参数：cb 调度员拆掉用户MIC通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：暂不可用
\end{sphinxVerbatim}

\item {} 
设置开始录音回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}start\PYGZus{}record\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}recordfile cb)
参数：cb 获取MCI通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：开始录音时触发，通知群组ID、讲话人ID和录音参数（文件名、当前时间、状态（成功/失败））
\end{sphinxVerbatim}

\item {} 
设置录音结束回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}finish\PYGZus{}record\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}end\PYGZus{}recordfile cb)
参数：cb 录音结束通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：有停止录音时触发，通知群组ID、讲话人ID和录音参数（文件名、当前时间、状态（成功/失败））
\end{sphinxVerbatim}

\item {} 
设置发送录音回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}send\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}send\PYGZus{}callback cb)
参数：cb 发送通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：发送录音，服务器返回时触发，通知发送结果（成功  True；失败  False）
\end{sphinxVerbatim}

\item {} 
设置播放录音文件结束回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}play\PYGZus{}recordfile\PYGZus{}end\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}play\PYGZus{}recordfile\PYGZus{}end cb)
参数：cb 播放录音文件结束通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：本地录音结束时触发，通知
\end{sphinxVerbatim}

\item {} 
设置遥开摇闭回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}audio\PYGZus{}enabledcall\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}audio\PYGZus{}enabled\PYGZus{}callback cb)
参数：cb 管理员设置用户的遥开摇闭时的通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：管理员设置用户的遥开摇闭服务器返回时触发，通知结果（成功  True；失败  False）、状态（遥开 1；摇闭 0）、被摇闭的用户ID列表
\end{sphinxVerbatim}

\item {} 
设置定位开启关闭回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}set\PYGZus{}switch\PYGZus{}location\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}switch\PYGZus{}location cb)
参数：cb 管理员设置用户定位时的通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：管理员设置用户定位服务器返回时触发，通知结果（成功  True；失败  False）、状态（开启 1；关闭 0）、被打开的用户ID列表
\end{sphinxVerbatim}

\item {} 
设置多媒体消息回调

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
接口：int echat\PYGZus{}win\PYGZus{}setmultimedia\PYGZus{}message\PYGZus{}cb(win\PYGZus{}pfn\PYGZus{}multimedia\PYGZus{}message cb)
参数：cb 收到多媒体消息的通知函数
返回：成功 0；失败 \PYGZhy{}1
注意：当服务器推送多媒体消息时触发，通知收到的消息
\end{sphinxVerbatim}

\end{itemize}


\section{4 错误信息标识}
\label{\detokenize{c_win:id13}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}ACCOUNT\PYGZus{}ERROR}             \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}      \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号密码错误}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}ACCOUNT\PYGZus{}OUTSERVICE}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}      \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号已欠费或已超出服务期}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}ACCOUNT\PYGZus{}NOEXIST}           \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}      \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号不存在}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}INVALID\PYGZus{}LOGIN\PYGZus{}PRIVILEGE}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}      \PYG{o}{/}\PYG{o}{/}\PYG{n}{无效的帐号登录权限}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}ACCOUNT\PYGZus{}NOCONFIG}          \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}      \PYG{o}{/}\PYG{o}{/}\PYG{n}{没有配置帐号信息}

\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}KICKOUT}                   \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号已在其他位置登录}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}LOGIN\PYGZus{}TIMEOUT}             \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{11}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号登录超时}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}LOGOUT}                    \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{帐号已注销}

\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}NETWORK\PYGZus{}DISCONNECT}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{网络连接失败}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}NETWORK\PYGZus{}RECONECTING}       \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{21}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{网络正在重连}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}CANNOT\PYGZus{}CONNECT}            \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{22}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{无法连接服务器}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}NETWORK\PYGZus{}CONECTING}         \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{23}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{正在连接服务器}

\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}JOIN\PYGZus{}GROUP\PYGZus{}FAILED}         \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{加入群组失败}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}JOIN\PYGZus{}GROUP\PYGZus{}TIMEOUT}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{31}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{加入群组请求超时}

\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}REFUSED}            \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{抢麦被拒绝}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}REPEATEDLY}         \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{41}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{短暂时间内多次抢麦}\PYG{p}{,}\PYG{n}{不允许}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}IN\PYGZus{}AUDIOENABLE}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{42}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{遥闭状态抢麦}\PYG{p}{,}\PYG{n}{不允许}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}IN\PYGZus{}ERR\PYGZus{}SSTATE}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{43}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{内部会话状态错误}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}NO\PYGZus{}AUDIOFOCUS}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{44}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{抢麦时申请音频焦点失败}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}IN\PYGZus{}LOW\PYGZus{}ROLE}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{45}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{以较低的角色值抢麦}
\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}REQMIC\PYGZus{}TIMEOUT}            \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{46}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{接收抢麦回应超时}

\PYG{n}{ECHAT\PYGZus{}ERR\PYGZus{}RECORD\PYGZus{}DEVICE}             \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{50}     \PYG{o}{/}\PYG{o}{/}\PYG{n}{打开录音设备失败}
\end{sphinxVerbatim}


\section{5 常用枚举定义}
\label{\detokenize{c_win:id14}}

\section{6 结构类型定义}
\label{\detokenize{c_win:id15}}

\chapter{C\# Windows集成}
\label{\detokenize{index:id1}}

\section{概述}
\label{\detokenize{csharp::doc}}\label{\detokenize{csharp:id1}}
此 C\# SDK 适用于.net framework\textgreater{}2.0版本，基于 善理公版引擎 C++ API 构建。


\subsection{安装}
\label{\detokenize{csharp:id2}}\begin{itemize}
\item {} 
引用\sphinxcode{\sphinxupquote{ShanliTech.EChat.SDK.DLL}} 到项目中。

\end{itemize}

{\color{red}\bfseries{}**}注意：SDK分为32位和64位，请根据引入的SDK设置为 \sphinxcode{\sphinxupquote{平台目标}} **

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{D:微信图片_20180124184017}.png}
\caption{微信图片\_20180124184017}\label{\detokenize{csharp:id93}}\end{figure}


\subsubsection{文件目录}
\label{\detokenize{csharp:id5}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{n}{eChat}\PYG{o}{\PYGZhy{}}\PYG{n}{CSharp}\PYG{o}{\PYGZhy{}}\PYG{n}{SDK\PYGZus{}V1}\PYG{o}{.}\PYG{l+m+mi}{0}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{libs}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{x86}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{ShanliTech}\PYG{o}{.}\PYG{n}{EChat}\PYG{o}{.}\PYG{n}{SDK}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{amrcc}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{echat}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{echat}\PYG{o}{.}\PYG{n}{ini}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{echat\PYGZus{}log}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{evrcc}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{libscl}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{msvcp120d}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{msvcr120d}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pthreadVSE2}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{vccorlib120d}\PYG{o}{.}\PYG{n}{dll}
 \PYG{o}{\textbar{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{x64}
\end{sphinxVerbatim}


\subsubsection{依赖库文件}
\label{\detokenize{csharp:id6}}\begin{itemize}
\item {} 
从文件夹lib拷贝关联的dll到bin目录下。

\end{itemize}

NAudio.dll、amrcc.dll、echat.dll、echat.ini、echat\_log.dll、evrcc.dll、libscl.dll、msvcp120d.dll、msvcr120d.dll、pthreadVSE2.dll、vccorlib120d.dll


\subsubsection{其他}
\label{\detokenize{csharp:id7}}
C\# SDK引用了第三方的开源项目
NAudio,因此，您需要在项目中引用它(可以使用NuGet管理dll)


\subsection{初始化}
\label{\detokenize{csharp:id8}}

\subsubsection{初始化配置}
\label{\detokenize{csharp:id9}}\begin{itemize}
\item {} 
传参返回值采用UTF-8编码

\item {} 
\sphinxcode{\sphinxupquote{Context}} 和 \sphinxcode{\sphinxupquote{Dns}} 配置，修改echat.ini文件：

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{account}\PYG{p}{]}
\PYG{n}{context} \PYG{o}{=} \PYG{n}{dev}
\PYG{p}{[}\PYG{n}{network}\PYG{p}{]}
\PYG{n}{dns} \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{n}{语音服务IP}\PYG{p}{:}\PYG{n}{端口}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{初始化DLL加载}
\label{\detokenize{csharp:dll}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
// 启动必须先完成初始化的工作，否则开发包无法正常运行
EChat.EChatApi.Init();

// 在退出前也需要对库进行释放
Chat.EChatApi.UnInit();

// 向外层发送错误通知，包括错误信息及错误码
EChat.Net.EChatApi.Instance.onError += Instance\PYGZus{}onError;
private static void Instance\PYGZus{}onError(string message, int error)
        \PYGZob{}
            string result = string.Empty;
            switch (error)
            \PYGZob{}
                case \PYGZhy{}1:
                    result = \PYGZdq{}账号密码错误\PYGZdq{};
                    break;
                case \PYGZhy{}2:
                    result = \PYGZdq{}账号已欠费或超出服务期\PYGZdq{};
                    break;
                case \PYGZhy{}3:
                    result = \PYGZdq{}账号不存在\PYGZdq{};
                    break;
                case \PYGZhy{}4:
                    result = \PYGZdq{}无效的账号登录权限\PYGZdq{};
                    break;
                case \PYGZhy{}10:
                    result = \PYGZdq{}账号已在其它位置登录\PYGZdq{};
                    break;
                case \PYGZhy{}11:
                    result = \PYGZdq{}账号登录超时\PYGZdq{};
                    break;
                case \PYGZhy{}20:
                    result = \PYGZdq{}网络连接失败\PYGZdq{};
                    break;
                case \PYGZhy{}21:
                    result = \PYGZdq{}网络正在重连\PYGZdq{};
                    break;
                case \PYGZhy{}30:
                    result = \PYGZdq{}加入群组失败\PYGZdq{};
                    break;
                case \PYGZhy{}31:
                    result = \PYGZdq{}加入群组请求超时\PYGZdq{};
                    break;
                case \PYGZhy{}40:
                    result = \PYGZdq{}当前有人正在讲话\PYGZlt{}服务器回馈\PYGZgt{}\PYGZdq{};
                    break;
                case \PYGZhy{}41:
                    result = \PYGZdq{}短时间内不允许多次抢麦\PYGZdq{};
                    break;
                case \PYGZhy{}42:
                    result = \PYGZdq{}摇闭状态不允许抢麦\PYGZdq{};
                    break;
                case \PYGZhy{}43:
                    result = \PYGZdq{}内部会话状态错误\PYGZlt{}主动放麦后立马去抢麦\PYGZgt{}\PYGZdq{};
                    break;
                case \PYGZhy{}44:
                    result = \PYGZdq{}抢麦时申请音频焦点失败\PYGZdq{};
                    break;
                case \PYGZhy{}45:
                    result = \PYGZdq{}已较低的优先级抢麦\PYGZlt{}出现在当时正在有人讲话，自身比讲话人优先级低时\PYGZgt{}\PYGZdq{};
                    break;
                   case \PYGZhy{}46:
                    result = \PYGZdq{}网络不稳定\PYGZdq{};
                    break;
                case \PYGZhy{}50:
                    result = \PYGZdq{}打开录音设备失败\PYGZdq{};
                    break;
            \PYGZcb{}
        \PYGZcb{}
\end{sphinxVerbatim}


\section{接口定义}
\label{\detokenize{csharp:id10}}

\subsection{账号管理}
\label{\detokenize{csharp:id11}}

\subsubsection{登录}
\label{\detokenize{csharp:id12}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Login}\PYG{p}{(}\PYG{n}{string} \PYG{n}{account}\PYG{p}{,} \PYG{n}{string} \PYG{n}{password}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{role}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
account
&
用户名
&\\
\hline
password
&
明文密码
&\\
\hline
role
&
用户角色，0:对讲用户；3：调度员
&
调度台请使用 3
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值
\begin{quote}

执行成功标示 0：成功 ，-1：失败
\end{quote}

\item {} 
通知事件

\item {} 
\sphinxcode{\sphinxupquote{onOnlineStatusChanged}} ，当用户登录成功后触发，\sphinxcode{\sphinxupquote{OnlineStatus}}
状态改为 \sphinxcode{\sphinxupquote{ONLINE\_STATUS\_ONLINE}} 参考 {\hyperref[\detokenize{csharp:loginStatus}]{\emph{通知事件 -
登录状态改变通知}}}

\item {} 
\sphinxcode{\sphinxupquote{OnError}}，当用户登录失败时触发。参考 {\hyperref[\detokenize{csharp:init}]{\emph{配置及加载 -
初始化}}}

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{o}{/} \PYG{n}{创建用户管理对象}
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{onOnlineStatusChanged} \PYG{o}{+}\PYG{o}{=} \PYG{n}{accountManager\PYGZus{}onOnlineStatusChanged}\PYG{p}{;}
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{Login}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{13800000009}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}

\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/}  \PYG{n}{用户登录成功的通知}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{param} \PYG{n}{name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户在线枚举} \PYG{p}{[}\PYG{p}{]}\PYG{p}{(}\PYG{p}{)}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{param}\PYG{o}{\PYGZgt{}}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{accountManager\PYGZus{}onOnlineStatusChanged}\PYG{p}{(}\PYG{n}{OnlineStatus} \PYG{n}{status}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{status} \PYG{o}{==} \PYG{n}{Net}\PYG{o}{.}\PYG{n}{OnlineStatus}\PYG{o}{.}\PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE}\PYG{p}{)}
  \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/}\PYG{n}{登录成功}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{注销}
\label{\detokenize{csharp:id13}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{void} \PYG{n}{Logout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

无
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{Logout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\subsubsection{账号信息查询}
\label{\detokenize{csharp:id14}}

\paragraph{获取用户信息}
\label{\detokenize{csharp:id15}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{User} \PYG{n}{GetCurrentUser}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

用户实体类 User 参考 {\hyperref[\detokenize{csharp:user}]{\emph{实体类定义 -\textgreater{} 用户实体类}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{user} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{GetCurrentUser}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

​


\paragraph{获取在线状态}
\label{\detokenize{csharp:id16}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{OnlineStatus} \PYG{n}{GetOnlineStatus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

返回在线状态的枚举，参考： {\hyperref[\detokenize{csharp:onlineStatus}]{\emph{常用枚举 -\textgreater{} 用户在线}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{status} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{GetOnlineStatus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{获取当前账号UID}
\label{\detokenize{csharp:uid}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{GetUid}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

返回当前登录用户的UID
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uid} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{GetUid}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{获取用户名}
\label{\detokenize{csharp:id17}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

返回当前登录用户的中文名
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{name} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{GetName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{是否被禁言状}
\label{\detokenize{csharp:id18}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{HasAudioEnabled}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

布尔类型， true：正常发言 ，false：被禁言。
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{hasAudioEnabled} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{HasAudioEnabled}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\subsubsection{更改账号信息}
\label{\detokenize{csharp:id19}}

\paragraph{修改用户名}
\label{\detokenize{csharp:id20}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ChangeName}\PYG{p}{(}\PYG{n}{string} \PYG{n}{name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
name
&
新用户名称
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

\sphinxcode{\sphinxupquote{onChangeNameResult}} 修改用户名触发此事件，事件处理是否修改成功。
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{ChangeName}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{张三}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{\PYGZus{}accountManager}\PYG{o}{.}\PYG{n}{onChangeNameResult} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onChangeNameResult}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onChangeNameResult}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\paragraph{修改密码}
\label{\detokenize{csharp:id21}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ChangePassword}\PYG{p}{(}\PYG{n}{string} \PYG{n}{oldpassword}\PYG{p}{,} \PYG{n}{string} \PYG{n}{newpassword}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
oldpassword
&
旧密码
&\\
\hline
newpassword
&
新密码
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

\sphinxcode{\sphinxupquote{onChangePasswordResult}} , 修改密码触发此事件，事件处理是否修改成功
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{ChangePassword}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{123456}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{qwe}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{\PYGZus{}accountManager}\PYG{o}{.}\PYG{n}{onChangePasswordResult} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onChangePasswordResult}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onChangePasswordResult}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{本地账号存储}
\label{\detokenize{csharp:id22}}

\paragraph{保存账号}
\label{\detokenize{csharp:id23}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SaveAccount}\PYG{p}{(}\PYG{n}{Account} \PYG{n}{account}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

传入账号实体类， 请参考 {\hyperref[\detokenize{csharp:account}]{\emph{实体类定义 -\textgreater{} 账号实体类}}} 定义。
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{account} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Account}\PYG{p}{(}\PYG{n}{Config}\PYG{o}{.}\PYG{n}{Account}\PYG{p}{,} \PYG{n}{Config}\PYG{o}{.}\PYG{n}{Password}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{SaveAccount}\PYG{p}{(}\PYG{n}{account}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{ret} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{成功}
\PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{ret} \PYG{o}{==} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{失败}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\paragraph{清空已保存账号}
\label{\detokenize{csharp:id24}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ClearAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{ClearAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{ret} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{成功}
\PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{ret} \PYG{o}{==} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{失败}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{是否已保存账号}
\label{\detokenize{csharp:id25}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{HasAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 true：有 ，false：无
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{HasAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{ret}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{存在}
\PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{ret} \PYG{o}{==} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{不存在}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{获取已保存的账号}
\label{\detokenize{csharp:id26}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{Account} \PYG{n}{GetSavedAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

返回账号实体类，请参考 {\hyperref[\detokenize{csharp:account}]{\emph{实体类定义 -\textgreater{} 账号实体类}}} 定义。
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{account} \PYG{o}{=} \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{GetSavedAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{account} \PYG{o}{!=}\PYG{n}{null}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{todo}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\paragraph{使用已存储的账号登录}
\label{\detokenize{csharp:id27}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public}  \PYG{n+nb}{int}  \PYG{n}{LoginWithSaved}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\item {} 
\sphinxcode{\sphinxupquote{onOnlineStatusChanged}} ，当用户登录成功后触发，\sphinxcode{\sphinxupquote{OnlineStatus}}
状态改为 \sphinxcode{\sphinxupquote{ONLINE\_STATUS\_ONLINE}} 参考 {\hyperref[\detokenize{csharp:loginStatus}]{\emph{通知事件 -
登录状态改变通知}}}

\item {} 
\sphinxcode{\sphinxupquote{OnError}}，当用户登录失败时触发。参考 {\hyperref[\detokenize{csharp:init}]{\emph{配置及加载 -
初始化}}}

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{accountManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{AccountManager}\PYG{p}{;}
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{LoginWithSaved}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/}  \PYG{n}{用户登录成功的通知}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{param} \PYG{n}{name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户在线枚举}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{param}\PYG{o}{\PYGZgt{}}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{accountManager\PYGZus{}onOnlineStatusChanged}\PYG{p}{(}\PYG{n}{OnlineStatus} \PYG{n}{status}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{status} \PYG{o}{==} \PYG{n}{Net}\PYG{o}{.}\PYG{n}{OnlineStatus}\PYG{o}{.}\PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE}\PYG{p}{)}
  \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/}\PYG{n}{登录成功}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{通知事件}
\label{\detokenize{csharp:id28}}

\paragraph{登录状态改变通知}
\label{\detokenize{csharp:id29}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{o}{/} \PYG{n}{事件}
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}online\PYGZus{}status} \PYG{n}{onOnlineStatusChanged}\PYG{p}{;}
\end{sphinxVerbatim}

​
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{o}{/} \PYG{n}{注册事件}
\PYG{n}{\PYGZus{}accountManager}\PYG{o}{.}\PYG{n}{onOnlineStatusChanged} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onOnlineStatusChanged}\PYG{p}{;}

\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/}  \PYG{n}{用户登录成功的通知}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{param} \PYG{n}{name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户在线枚举} \PYG{p}{[}\PYG{p}{]}\PYG{p}{(}\PYG{p}{)}
\PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{param}\PYG{o}{\PYGZgt{}}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onOnlineStatusChanged}\PYG{p}{(}\PYG{n}{OnlineStatus} \PYG{n}{status}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{status} \PYG{o}{==} \PYG{n}{Net}\PYG{o}{.}\PYG{n}{OnlineStatus}\PYG{o}{.}\PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE}\PYG{p}{)}
  \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/}\PYG{n}{登录成功}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

参考： {\hyperref[\detokenize{csharp:onlineStatus}]{\emph{常用枚举 -\textgreater{} 在线状态}}}


\paragraph{修改用户通知}
\label{\detokenize{csharp:id30}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}change\PYGZus{}name} \PYG{n}{onChangeNameResult}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{onChangeNameResult} \PYG{o}{+}\PYG{o}{=} \PYG{n}{accountManager\PYGZus{}onChangeNameResult}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{accountManager\PYGZus{}onChangeNameResult}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/} \PYG{n}{成功}
    \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/} \PYG{n}{失败}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\paragraph{修改密码通知}
\label{\detokenize{csharp:id31}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}change\PYGZus{}password} \PYG{n}{onChangePasswordResult}\PYG{p}{;}
\end{sphinxVerbatim}

​
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{onChangePasswordResult} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onChangePasswordResult}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{accountManager\PYGZus{}onChangePasswordResult}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/} \PYG{n}{成功}
    \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/} \PYG{n}{失败}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{当前用户遥开遥闭状态通知}
\label{\detokenize{csharp:id32}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}audio\PYGZus{}enable} \PYG{n}{onAudioEnableChanged}\PYG{p}{;}
\end{sphinxVerbatim}

​
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{n}{accountManager}\PYG{o}{.}\PYG{n}{onAudioEnableChanged} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onAudioEnableChanged}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}accountManager\PYGZus{}onAudioEnableChanged}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{audioEnable}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{audioEnable}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{遥开}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{遥闭}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{注册监听用户状态变化}
\label{\detokenize{csharp:id33}}\begin{itemize}
\item {} 
被动触发条件 echat 服务内部 User
缓存变更时触发，例如用户状态改变或用户名改变。

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{onUserChanged} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}groupManager\PYGZus{}onUserChanged}\PYG{p}{;}

\PYG{n}{void} \PYG{n}{groupManager\PYGZus{}onUserChanged}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{count}\PYG{p}{,} \PYG{n}{Net}\PYG{o}{.}\PYG{n}{User}\PYG{p}{[}\PYG{p}{]} \PYG{n}{users}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
   \PYG{n}{Console}\PYG{o}{.}\PYG{n}{WriteLine}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{有}\PYG{l+s+si}{\PYGZob{}0\PYGZcb{}}\PYG{l+s+s2}{个用户状态更新了，我是否需要？}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{count}\PYG{p}{)}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{群组}
\label{\detokenize{csharp:id34}}

\subsubsection{加入群组}
\label{\detokenize{csharp:id35}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{JoinGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
gid
&
群组Id
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

见 {\hyperref[\detokenize{csharp:groupEvent}]{\emph{通知事件}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
var groupManager = EChat.Net.EChatApi.Instance.GroupManager;
int result = groupManager.JoinGroup(gid);
if( result == 0)\PYGZob{}
  // 执行成功，当前群组切换通知
\PYGZcb{}
\end{sphinxVerbatim}

​


\subsubsection{离开群组}
\label{\detokenize{csharp:id36}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{LeaveGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

见 {\hyperref[\detokenize{csharp:groupEvent}]{\emph{通知事件}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
var groupManager = EChat.Net.EChatApi.Instance.GroupManager;
int result = groupManager.LeaveGroup();
if( result == 0)\PYGZob{}
  // 执行成功，当前群组切换通知
\PYGZcb{}
\end{sphinxVerbatim}


\subsubsection{创建临时群组}
\label{\detokenize{csharp:id37}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public int Call(long[] uids)；
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
uids
&
用户uid 数组
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

见 {\hyperref[\detokenize{csharp:groupEvent}]{\emph{通知事件}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{call}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\subsubsection{销毁临时群组}
\label{\detokenize{csharp:id38}}
临时群组创建者退出临时群组即为销毁临时群组。


\subsubsection{群组信息查询}
\label{\detokenize{csharp:id39}}

\paragraph{获取群组列表}
\label{\detokenize{csharp:id40}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{Group}\PYG{p}{[}\PYG{p}{]} \PYG{n}{GetGroupList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

{\hyperref[\detokenize{csharp:group}]{\emph{Group 实体数组}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{groups} \PYG{o}{=} \PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{GetGroupList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

​


\paragraph{根据GID 查询群组信息}
\label{\detokenize{csharp:gid}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{Group} \PYG{n}{GetGroupByGid}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
gid
&
群组Id
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

群组实体
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{group} \PYG{o}{=} \PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{GetGroupByGid}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{获取当前群组所在Id}
\label{\detokenize{csharp:id}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{GetCurrentGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

当前群组 Id
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{gid} \PYG{o}{=} \PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{GetCurrentGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

​


\paragraph{获取成员列表}
\label{\detokenize{csharp:id41}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{Member}\PYG{p}{[}\PYG{p}{]} \PYG{n}{GetMemberList}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
gid
&
群组Id
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

见 {\hyperref[\detokenize{csharp:member}]{\emph{成员实体}}}


\subsubsection{群组设置}
\label{\detokenize{csharp:id42}}

\paragraph{监听群组}
\label{\detokenize{csharp:id43}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartWatchGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
gid
&
群组Id
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{var} \PYG{k}{return}  \PYG{o}{=} \PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{k}{return} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{TODO} \PYG{n}{成功监听}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​

​


\paragraph{取消监听群组}
\label{\detokenize{csharp:id44}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{Group} \PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
gid
&
群组Id
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值

\end{itemize}

见 {\hyperref[\detokenize{csharp:group}]{\emph{群组实体}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{groupManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{GroupManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{group} \PYG{o}{=} \PYG{n}{groupManager}\PYG{o}{.}\PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{group} \PYG{o}{!=}\PYG{n}{null}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{n}{Console}\PYG{o}{.}\PYG{n}{WriteLine}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ gid ：}\PYG{l+s+si}{\PYGZob{}0\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{group}\PYG{o}{.}\PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\bigskip\hrule\bigskip






通知事件


\paragraph{群组变化事件}
\label{\detokenize{csharp:id45}}
\sphinxstylestrong{被动触发}
\begin{itemize}
\item {} 
其他成员进入所在的组时

\item {} 
其他成员在自身所在的组下线时

\item {} 
切换群组时

\end{itemize}

\sphinxstylestrong{主动触发}
\begin{itemize}
\item {} 
进组

\item {} 
创建临时组

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
//当前所在群组变化通知
//public event win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}current\PYGZus{}group onCurrentGroup;

//群组列表发生变化通知
//public event win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}grouplist onGroupList;

//群组成员发生变化通知
//public event win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}members\PYGZus{}changed onMemberChanged;

//成员列表获取完毕
//public event win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}memberlist onMemberList;

var groupManager = EChat.Net.EChatApi.Instance.GroupManager;
groupManager.onGroupList += groupManager\PYGZus{}onGroupList;
groupManager.onCurrentGroup += groupManager\PYGZus{}onCurrentGroup;
groupManager.onMemberChanged += groupManager\PYGZus{}onMemberChanged;
groupManager.onMemberList += groupManager\PYGZus{}onMemberList;

void groupManager\PYGZus{}onCurrentGroup(int gid, string group\PYGZus{}name)
\PYGZob{}
    // 更新当前成员列表
\PYGZcb{}

void groupManager\PYGZus{}onGroupList()
\PYGZob{}
    // 刷新群组列表
\PYGZcb{}
void groupManager\PYGZus{}onMemberChanged(int gid, int[] us, int uc, int[] rs, int rc, int[] js, int jc, int[] ls, int lc)
\PYGZob{}
  //增量更新成员列表
  // us 新加入当前群组人员id， 调度台强拆动作
  // rs 退出当前群组人员id， 调度台强拉动作
  // js 进入当前群组人员 id
  // ls 离开当前群组人员id
\PYGZcb{}

void groupManager\PYGZus{}onMemberList(int gid)
\PYGZob{}
 //更新成员列表
\PYGZcb{}
\end{sphinxVerbatim}


\subsection{对讲}
\label{\detokenize{csharp:id46}}

\subsubsection{抢麦 - 获取话权}
\label{\detokenize{csharp:id47}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

见 {\hyperref[\detokenize{csharp:startSpeak}]{\emph{抢麦通知}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{talkManager} \PYG{o}{=} \PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{GetInstance}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{TalkManager}\PYG{p}{;}
\PYG{n}{talkManager}\PYG{o}{.}\PYG{n}{onStartSpeak} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}talkManager\PYGZus{}onStartSpeak}\PYG{p}{;}
\PYG{n}{talkManger}\PYG{o}{.}\PYG{n}{StartSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}talkManager\PYGZus{}onStartSpeak}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{TODO} \PYG{n}{抢到麦权}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\subsubsection{放麦 - 释放话权}
\label{\detokenize{csharp:id48}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public int StopSpeak()；
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

执行成功标示 0：成功 ，-1：失败
\begin{itemize}
\item {} 
通知事件

\end{itemize}

{\hyperref[\detokenize{csharp:stopSpaek}]{\emph{放麦通知}}}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{talkManager} \PYG{o}{=} \PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{GetInstance}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{TalkManager}\PYG{p}{;}
\PYG{n}{talkManager}\PYG{o}{.}\PYG{n}{onStopSpeak} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}talkManager\PYGZus{}onStopSpeak}\PYG{p}{;}
\PYG{n}{talkManger}\PYG{o}{.}\PYG{n}{StopSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}talkManager\PYGZus{}onStopSpeak}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{TODO} \PYG{n}{释放麦权}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{对讲信息查询}
\label{\detokenize{csharp:id49}}

\paragraph{查询当前播放语音的用户}
\label{\detokenize{csharp:id50}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public User GetPlayingSoundUser()；
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

见 {\hyperref[\detokenize{csharp:user}]{\emph{用户实体}}}

​


\subsubsection{查询当前所有再讲话的用户}
\label{\detokenize{csharp:id51}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{User}\PYG{p}{[}\PYG{p}{]} \PYG{n}{GetSpeakingUsers}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

见 {\hyperref[\detokenize{csharp:user}]{\emph{用户实体数组}}}
\begin{itemize}
\item {} 
示例

\end{itemize}


\subsubsection{自己当前是否正在讲话}
\label{\detokenize{csharp:id52}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{IsSpeaking}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 true：在说话 ，false：没有说话

​


\subsubsection{自己当前是否正收听语音}
\label{\detokenize{csharp:id53}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{IsListening}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数

\end{itemize}

无
\begin{itemize}
\item {} 
返回值

\end{itemize}

成功标示 true：在说话 ，false：没有说话


\subsubsection{通知事件}
\label{\detokenize{csharp:id54}}

\bigskip\hrule\bigskip






抢麦通知
\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}speak} \PYG{n}{onStartSpeak}\PYG{p}{;}
\end{sphinxVerbatim}

​


\bigskip\hrule\bigskip






放麦通知
\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}speak} \PYG{n}{onStartSpeak}\PYG{p}{;}
\end{sphinxVerbatim}

​
\begin{itemize}
\item {} 
示例

\end{itemize}


\paragraph{有人讲话通知}
\label{\detokenize{csharp:id55}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}playing\PYGZus{}sound} \PYG{n}{onStartPlaying}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{talkManager} \PYG{o}{=} \PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{GetInstance}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{TalkManager}\PYG{p}{;}
\PYG{n}{talkManager}\PYG{o}{.}\PYG{n}{onStartPlaying} \PYG{o}{+}\PYG{o}{=} \PYG{n}{talkManager\PYGZus{}onStartPlaying}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}talkManager\PYGZus{}onStartPlaying}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{uid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/} \PYG{n}{TODO} \PYG{n}{其他人讲话}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

​


\paragraph{讲话停止通知}
\label{\detokenize{csharp:id56}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}user\PYGZus{}stop\PYGZus{}speak} \PYG{n}{onUserStopSpeak}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{talkManager} \PYG{o}{=} \PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{GetInstance}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{TalkManager}\PYG{p}{;}
\PYG{n}{talkManager}\PYG{o}{.}\PYG{n}{onStopPlaying} \PYG{o}{+}\PYG{o}{=} \PYG{n}{talkManager\PYGZus{}onStopPlaying}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{talkManager\PYGZus{}onStopPlaying}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{uid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{string} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
   \PYG{o}{/}\PYG{o}{/} \PYG{n}{TODO} \PYG{n}{其他人停止讲话}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{广播}
\label{\detokenize{csharp:id57}}

\subsubsection{文字广播}
\label{\detokenize{csharp:id58}}

\paragraph{发送文字广播}
\label{\detokenize{csharp:id59}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SendTextBroadcast}\PYG{p}{(}\PYG{n}{string} \PYG{n}{text}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|*{3}{\X{1}{3}|}}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
text
&
文字信息
&
文字长度1-40；编码格式uft-8
\\
\hline
uids
&
收听广播的用户ID集合
&\begin{itemize}
\item {} \begin{itemize}
\item {} 
\end{itemize}

\end{itemize}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{50711} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{SendTextBroadcast}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{测试文字广播}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{语音广播}
\label{\detokenize{csharp:id60}}

\paragraph{开始录制音频文件}
\label{\detokenize{csharp:id61}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{StartRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\paragraph{停止录制音频文件}
\label{\detokenize{csharp:id62}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StopRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{StopRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\paragraph{发送语音广播}
\label{\detokenize{csharp:id63}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SendAudioBroadcast}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|*{3}{\X{1}{3}|}}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
uids
&
收听广播的用户ID集合
&\begin{itemize}
\item {} \begin{itemize}
\item {} 
\end{itemize}

\end{itemize}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 var \PYGZus{}broadcastManager = EChat.Net.EChatApi.Instance.BroadcastManager;
 var uids = new[] \PYGZob{} 50711 \PYGZcb{};
\PYGZus{}broadcastManager.SendAudioBroadcast(uids)；
\end{sphinxVerbatim}


\paragraph{播放已录制的待播放音频文件}
\label{\detokenize{csharp:id64}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{PlayRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{PlayRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{事件定义}
\label{\detokenize{csharp:id65}}

\paragraph{录音结束回调}
\label{\detokenize{csharp:id66}}\begin{itemize}
\item {} 
主动触发条件 执行 PlayRecordBroadcastAudio 方法

\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public event win\PYGZus{}pfn\PYGZus{}broadcast\PYGZus{}play\PYGZus{}async\PYGZus{}stop OnPlayStop；
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{OnPlayStop} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}broadcastManager\PYGZus{}OnPlayStop}\PYG{p}{;}
\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}broadcastManager\PYGZus{}OnPlayStop}\PYG{p}{(}\PYG{p}{)}
\PYG{p}{\PYGZob{}}

\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{发送广播结果回调}
\label{\detokenize{csharp:id67}}\begin{itemize}
\item {} 
主动触发条件 执行 SendAudioBroadcast 方法

\end{itemize}

执行SendTextBroadcast方法
\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}send\PYGZus{}callback} \PYG{n}{onSended}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}broadcastManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{BroadcastManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}broadcastManager}\PYG{o}{.}\PYG{n}{onSended} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}broadcastManager\PYGZus{}onSended}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}broadcastManager\PYGZus{}onSended}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
   \PYG{o}{/}\PYG{o}{/}\PYG{n}{发送成功}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{调度}
\label{\detokenize{csharp:id68}}

\subsubsection{临时加入组}
\label{\detokenize{csharp:id69}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{TempJoinGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
gid
&
临时加入群组编号
&
\textendash{}
\\
\hline
uids
&
用户ID集合
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{50711} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{TempJoinGroup}\PYG{p}{(}\PYG{l+m+mi}{600612}\PYG{p}{,} \PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\subsubsection{临时移出组}
\label{\detokenize{csharp:id70}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{TempLeaveGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
gid
&
群组Id
&
赋值为0
\\
\hline
uids
&
用户ID集合
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{50711} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{TempLeaveGroup}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

​


\subsubsection{遥开遥闭}
\label{\detokenize{csharp:id71}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Audioenable}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{,} \PYG{n+nb}{bool} \PYG{n}{audioenabled}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
uids
&
用户ID集合
&
\textendash{}
\\
\hline
audioenabled
&
true:开启 false:关闭
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{50711} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{Audioenable}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{,} \PYG{n}{true}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{强拉}
\label{\detokenize{csharp:id72}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

在群组列表中把在线不在本群组内的人员强拉回调度员所在群组

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ForceDispatch}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
uids
&
用户ID集合
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
var \PYGZus{}dispatchManager = EChat.Net.EChatApi.Instance.DispatchManager;
var uids = new[] \PYGZob{} 50711 \PYGZcb{};
\PYGZus{}dispatchManager.ForceDispatch(uids)；
\end{sphinxVerbatim}

​


\subsubsection{强拆}
\label{\detokenize{csharp:id73}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

在群组列表中把正在讲话的用户强拆，强制中断其语音

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Takemic}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
uids
&
用户ID集合
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行成功标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new}\PYG{p}{[}\PYG{p}{]} \PYG{p}{\PYGZob{}} \PYG{l+m+mi}{50711} \PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{Takemic}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

​


\subsubsection{事件定义}
\label{\detokenize{csharp:id74}}

\paragraph{强拉结果通知事件}
\label{\detokenize{csharp:id75}}\begin{itemize}
\item {} 
主动触发条件 执行ForceDispatch 方法

\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}dispatcher} \PYG{n}{onDispatched}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{onDispatched} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}dispatchManager\PYGZus{}onDispatched}\PYG{p}{;}

\PYG{n}{private} \PYG{n}{void} \PYG{n}{\PYGZus{}dispatchManager\PYGZus{}onDispatched}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{,} \PYG{n+nb}{bool} \PYG{n}{has\PYGZus{}gid}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{uid\PYGZus{}size}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{success}\PYG{p}{:}\PYG{n}{是否成功}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{has\PYGZus{}gid}\PYG{p}{:}\PYG{n}{是否有群组变化}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{gid}\PYG{p}{:}\PYG{n}{群组编号}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{uids}\PYG{p}{:}\PYG{n}{用户Id集合}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{uid\PYGZus{}size}\PYG{p}{:}\PYG{n}{用户Id的数量}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{强拆结果通知事件}
\label{\detokenize{csharp:id76}}\begin{itemize}
\item {} 
主动触发条件 执行 Takemic 方法

\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}takemic} \PYG{n}{onTakeMic}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{onTakeMic} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}dispatchManager\PYGZus{}onTakeMic}\PYG{p}{;}

\PYG{n}{public} \PYG{n}{delegate} \PYG{n}{void} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}takemic}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{uids\PYGZus{}size}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{success}  \PYG{n}{是否成功}
  \PYG{o}{/}\PYG{o}{/} \PYG{n}{uids}     \PYG{n}{用户Id集合}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{user\PYGZus{}size} \PYG{n}{用户Id数量}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\paragraph{遥开遥闭结果通知事件}
\label{\detokenize{csharp:id77}}\begin{itemize}
\item {} 
主动触发条件 执行 Audioenable方法

\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}audio\PYGZus{}enabled\PYGZus{}callback} \PYG{n}{onAudioEnabled}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}dispatchManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{DispatchManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}dispatchManager}\PYG{o}{.}\PYG{n}{onAudioEnabled} \PYG{o}{+}\PYG{o}{=} \PYG{n}{\PYGZus{}dispatchManager\PYGZus{}onAudioEnabled}\PYG{p}{;}
\PYG{n}{public} \PYG{n}{delegate} \PYG{n}{void} \PYG{n}{win\PYGZus{}pfn\PYGZus{}audio\PYGZus{}enabled\PYGZus{}callback}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{success}\PYG{p}{,} \PYG{n+nb}{bool} \PYG{n}{audio\PYGZus{}enabled}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{[}\PYG{p}{]} \PYG{n}{uids}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{size}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{success}       \PYG{n}{是否成功}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{audio\PYGZus{}enabled} \PYG{n}{遥开遥闭状态}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{uids}          \PYG{n}{用户Id集合}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{size}          \PYG{n}{用户Id数量}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{本地录音}
\label{\detokenize{csharp:id78}}

\subsubsection{设置本地录音}
\label{\detokenize{csharp:id79}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{EnableLocalRecord}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{enable}\PYG{p}{,} \PYG{n}{string} \PYG{n}{pathDir}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
enable
&
true:开启； false：关闭
&
\textendash{}
\\
\hline
pathDir
&
本地录音文件保存的路径
&
\textendash{}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}recordManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{RecordManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}recordManager}\PYG{o}{.}\PYG{n}{EnableLocalRecord}\PYG{p}{(}\PYG{n}{true}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{d:}\PYG{l+s+se}{\PYGZbs{}\PYGZdq{}}\PYG{l+s+s2}{);}
\end{sphinxVerbatim}


\subsubsection{播放本地录音}
\label{\detokenize{csharp:id80}}\begin{itemize}
\item {} 
方法签名

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{PlayLocalRecord}\PYG{p}{(}\PYG{n}{string} \PYG{n}{path}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
参数描述

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数定义
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
约束
\\
\hline
path
&
文件的绝对路径
&
播放的文件格式为evrc
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
返回值 执行标示：0【成功】 -1【失败】

\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var} \PYG{n}{\PYGZus{}recordManager} \PYG{o}{=} \PYG{n}{EChat}\PYG{o}{.}\PYG{n}{Net}\PYG{o}{.}\PYG{n}{EChatApi}\PYG{o}{.}\PYG{n}{Instance}\PYG{o}{.}\PYG{n}{RecordManager}\PYG{p}{;}
\PYG{n}{\PYGZus{}recordManager}\PYG{o}{.}\PYG{n}{PlayLocalRecord}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{D:}\PYG{l+s+se}{\PYGZbs{}201}\PYG{l+s+s2}{8\PYGZus{}1\PYGZus{}18\PYGZus{}13\PYGZus{}45\PYGZus{}4\PYGZus{}996\PYGZus{}600901\PYGZus{}50711.evrc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

​


\subsubsection{事件定义}
\label{\detokenize{csharp:id81}}

\paragraph{开始录音的通知事件}
\label{\detokenize{csharp:id82}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}recordfile} \PYG{n}{onStartRecord}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
var \PYGZus{}recordManager = EChat.Net.EChatApi.Instance.RecordManager;
\PYGZus{}recordManager.onStartRecord += \PYGZus{}recordManager\PYGZus{}onStartRecord;
public delegate void win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}start\PYGZus{}recordfile(int gid, int uid, string starttime, string filename)
\PYGZob{}
  //gid       群组Id
  //uid       用户Id
  //starttime 开始时间（绝对时间）
  //filename  文件名称

  //存储当前讲话者的基本信息
  Dictionary\PYGZlt{}string, object\PYGZgt{} ops = new Dictionary\PYGZlt{}string, object\PYGZgt{}();
  ops.Add(\PYGZdq{}speakername\PYGZdq{}, dispatchManager.GetUser(uid).name);
  ops.Add(\PYGZdq{}groupname\PYGZdq{}, groupManager.GetGroupByGid(gid).name);
  ops.Add(\PYGZdq{}gid\PYGZdq{}, gid);
  ops.Add(\PYGZdq{}uid\PYGZdq{}, uid);
  ops.Add(\PYGZdq{}starttime\PYGZdq{}, starttime);
  ops.Add(\PYGZdq{}filename\PYGZdq{}, filename);
  MimiCache.LOCAL\PYGZus{}RECORDS.Add(filename, ops);
\PYGZcb{}
\end{sphinxVerbatim}


\paragraph{结束录音的通知事件}
\label{\detokenize{csharp:id83}}\begin{itemize}
\item {} 
事件定义

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{event} \PYG{n}{win\PYGZus{}pfn\PYGZus{}notify\PYGZus{}end\PYGZus{}recordfile} \PYG{n}{onStopRecord}\PYG{p}{;}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
示例

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
var \PYGZus{}recordManager = EChat.Net.EChatApi.Instance.RecordManager;
\PYGZus{}recordManager.onStopRecord += \PYGZus{}recordManager\PYGZus{}onStopRecord;
private void \PYGZus{}recordManager\PYGZus{}onStopRecord(bool success, int gid, int uid, string finishtime, string filename)
\PYGZob{}
  //success 是否成功
  //git     群组ID
  //uid     用户ID
  //finishtime 结束时间（绝对时间）
  //文件名称

  //将录音成功的基本信息存储到队列中
\PYGZcb{}
\end{sphinxVerbatim}


\section{数据结构定义}
\label{\detokenize{csharp:id84}}

\subsection{账号信息}
\label{\detokenize{csharp:id85}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public struct Account
\PYGZob{}
       /// \PYGZlt{}summary\PYGZgt{}
       /// 登录名
       /// \PYGZlt{}/summary\PYGZgt{}
       public string Name

       /// \PYGZlt{}summary\PYGZgt{}
       /// 密码
       /// \PYGZlt{}/summary\PYGZgt{}
       public string Password

       /// \PYGZlt{}summary\PYGZgt{}
       /// 用户角色
       /// 0：对讲用户 3：调度员
       /// \PYGZlt{}/summary\PYGZgt{}
       public int Role

       /// \PYGZlt{}summary\PYGZgt{}
       /// 是否自动登录
       /// \PYGZlt{}/summary\PYGZgt{}
       public int IsAutoLogin

       /// \PYGZlt{}summary\PYGZgt{}
       /// 是否记住密码
       /// \PYGZlt{}/summary\PYGZgt{}
       public int IsRemembered
\PYGZcb{}
\end{sphinxVerbatim}


\subsection{群组信息}
\label{\detokenize{csharp:id86}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 public struct Group
   \PYGZob{}
    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组类型：1为普通组，2为临时组，3为紧急组
    /// \PYGZlt{}/summary\PYGZgt{}
    public int type;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组编号
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt32 gid;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组名称
    /// \PYGZlt{}/summary\PYGZgt{}
    public string name;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组优先级
    /// \PYGZlt{}/summary\PYGZgt{}
    public int prior;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 服务IP
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt32 ip;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 服务端口
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt16 port;
\PYGZcb{}
\end{sphinxVerbatim}


\subsection{用户信息}
\label{\detokenize{csharp:id87}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public struct User
\PYGZob{}
  /// \PYGZlt{}summary\PYGZgt{}
  /// 所在群组的编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public UInt32 gid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 用户编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public UInt32 uid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 用户角色 0：对讲用户 3：调度员
  /// \PYGZlt{}/summary\PYGZgt{}

  public UInt32 role;
  /// \PYGZlt{}summary\PYGZgt{}
  /// 在线状态
  /// \PYGZlt{}/summary\PYGZgt{}
  public int online;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 是否有群组编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public int has\PYGZus{}gid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 是否有角色
  /// \PYGZlt{}/summary\PYGZgt{}
  public int has\PYGZus{}role;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 语音状态是否打开
  /// \PYGZlt{}/summary\PYGZgt{}
  public int audio\PYGZus{}enabled;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 成员名称
  /// \PYGZlt{}/summary\PYGZgt{}
  public string name;
\PYGZcb{}
\end{sphinxVerbatim}


\subsection{成员信息}
\label{\detokenize{csharp:id88}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{struct} \PYG{n}{Member}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{所在群组的编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{gid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{uid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户角色}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{role}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{在线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{online}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否再组}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ingroup}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否有群组编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{has\PYGZus{}gid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否有角色}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{has\PYGZus{}role}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{语音状态是否打开}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{audio\PYGZus{}enabled}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{成员名称}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{string} \PYG{n}{name}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\section{数据定义}
\label{\detokenize{csharp:id89}}

\subsection{登录错误码}
\label{\detokenize{csharp:id90}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}1：帐号密码错误
\PYGZhy{}2：帐号已欠费或已超出服务期
\PYGZhy{}3：帐号不存在
\PYGZhy{}4：无效的帐号登录权限
\PYGZhy{}10：帐号已在其他位置登录
\PYGZhy{}11：帐号登录超时
\PYGZhy{}20：网络连接失败
\PYGZhy{}21：网络正在重连
\PYGZhy{}30：加入群组失败
\PYGZhy{}31：加入群组请求超时
\PYGZhy{}40:当前有人正在讲话\PYGZlt{}服务器回馈\PYGZgt{}
\PYGZhy{}41：短时间内不允许多次抢麦
\PYGZhy{}42：摇闭状态不允许抢麦
\PYGZhy{}43：内部会话状态错误\PYGZlt{}主动放麦后立马去抢麦\PYGZgt{}
\PYGZhy{}44：抢麦时申请音频焦点失败
\PYGZhy{}45：已较低的优先级抢麦\PYGZlt{}出现在当时正在有人讲话，自身比讲话人优先级低时\PYGZgt{}
\PYGZhy{}46：网络不稳定
\PYGZhy{}50：打开录音设备失败
\end{sphinxVerbatim}


\subsection{接口调用返回值}
\label{\detokenize{csharp:id91}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}1：操作失败
 0：操作成功
\end{sphinxVerbatim}


\subsection{用户在线状态}
\label{\detokenize{csharp:id92}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{enum} \PYG{n}{OnlineStatus}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{未知状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}UNKNOWN} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{离线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}OFFLINE} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{登录中}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}LOGINING} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{在线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\chapter{C\# Windows ActiveX集成}
\label{\detokenize{index:c-windows-activex}}

\section{安装}
\label{\detokenize{csharp_activex::doc}}\label{\detokenize{csharp_activex:id1}}\begin{itemize}
\item {} 
安装SetupEChatCom.msi

\item {} 
将ActiveX.cab文件放在Web的根目录下

\end{itemize}

​


\section{初始化}
\label{\detokenize{csharp_activex:id2}}

\subsection{初始化配置}
\label{\detokenize{csharp_activex:id3}}\begin{itemize}
\item {} 
传参返回值采用UTF-8编码

\item {} 
\sphinxcode{\sphinxupquote{Context}} 和 \sphinxcode{\sphinxupquote{Dns}}
配置，修改echat.ini文件（文件路径在桌面上面）：

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{account}\PYG{p}{]}
\PYG{n}{context} \PYG{o}{=} \PYG{n}{dev}
\PYG{p}{[}\PYG{n}{network}\PYG{p}{]}
\PYG{n}{dns} \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{n}{语音服务IP}\PYG{p}{:}\PYG{n}{端口}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

\end{itemize}


\section{示例}
\label{\detokenize{csharp_activex:id4}}

\subsection{登录示例}
\label{\detokenize{csharp_activex:id5}}

\subsubsection{加载ActiveX控件}
\label{\detokenize{csharp_activex:activex}}
注意： clsid必须为117343BA-BEAF-485D-B80C-7B5BE7395697不能更改

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{object} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{classid}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{clsid:117343BA\PYGZhy{}BEAF\PYGZhy{}485D\PYGZhy{}B80C\PYGZhy{}7B5BE7395697}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{codebase}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ActiveX.cab\PYGZsh{}version=1,0,0,0}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n+nb}{object}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{初始化EchatApi}
\label{\detokenize{csharp_activex:echatapi}}
注意：actix.Init()只能初始化一次。

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{actx} \PYG{o}{=} \PYG{n}{null}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{myself}\PYG{p}{;}
    \PYG{n}{function} \PYG{n}{start}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx} \PYG{o}{=} \PYG{n}{document}\PYG{o}{.}\PYG{n}{getElementById}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{actx} \PYG{o}{!=} \PYG{n}{null}\PYG{p}{)} \PYG{p}{\PYGZob{}}
            \PYG{o}{/}\PYG{o}{/}\PYG{n}{初始化EchatApi}
            \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Init}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
            \PYG{o}{/}\PYG{o}{/}\PYG{n}{登录方法}
            \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Login}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{13800000009}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{onload} \PYG{o}{=} \PYG{n}{start}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{登录成功事件}
\label{\detokenize{csharp_activex:id6}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onOnlineStatusChangedX(message)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{message} \PYG{o}{==} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{\PYGZob{}}
     \PYG{n}{window}\PYG{o}{.}\PYG{n}{location}\PYG{o}{.}\PYG{n}{href} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WebForm2.aspx}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{登录失败事件}
\label{\detokenize{csharp_activex:id7}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onErrorX(messag,error)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{错误码可以查询}  \PYG{n}{数据定义}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{登录错误码}
  \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onErrorX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{error}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsection{主页面示例}
\label{\detokenize{csharp_activex:id8}}

\subsubsection{加载ActiveX控件}
\label{\detokenize{csharp_activex:id9}}
注意： clsid必须为117343BA-BEAF-485D-B80C-7B5BE7395697不能更改

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{object} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{classid}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{clsid:117343BA\PYGZhy{}BEAF\PYGZhy{}485D\PYGZhy{}B80C\PYGZhy{}7B5BE7395697}\PYG{l+s+s2}{\PYGZdq{}}
       \PYG{n}{codebase}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ActiveX.cab\PYGZsh{}version=1,0,0,0}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n+nb}{object}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{初始化EchatApi中的事件}
\label{\detokenize{csharp_activex:id10}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{actx} \PYG{o}{=} \PYG{n}{null}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{myself}\PYG{p}{;}
    \PYG{n}{function} \PYG{n}{start}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx} \PYG{o}{=} \PYG{n}{document}\PYG{o}{.}\PYG{n}{getElementById}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{actx} \PYG{o}{!=} \PYG{n}{null}\PYG{p}{)} \PYG{p}{\PYGZob{}}
            \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Init2}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{window}\PYG{o}{.}\PYG{n}{onload} \PYG{o}{=} \PYG{n}{start}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\section{接口定义}
\label{\detokenize{csharp_activex:id11}}

\subsection{账号管理}
\label{\detokenize{csharp_activex:id12}}

\subsubsection{Login方法（String,String,Int)}
\label{\detokenize{csharp_activex:login-string-string-int}}
调度员登录方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id13}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Login}\PYG{p}{(}\PYG{n}{string} \PYG{n}{account}\PYG{p}{,} \PYG{n}{string} \PYG{n}{password}\PYG{p}{,} \PYG{n+nb}{int} \PYG{n}{role}\PYG{p}{)}
\end{sphinxVerbatim}

参数

account

​ Type:System.String

​ 登录账号

password

​ Type:System.String

​ 明文密码

role

​ Type:System.Int32

​ 用户角色，0:对讲用户；3：调度员

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{备注}
\label{\detokenize{csharp_activex:id14}}
参数role传固定值3


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id15}}\begin{itemize}
\item {} 
onOnlineStatusChangedX，当用户登录成功后触发，\sphinxcode{\sphinxupquote{OnlineStatus}} 为
\sphinxcode{\sphinxupquote{ONLINE\_STATUS\_ONLINE}}

\item {} 
\sphinxcode{\sphinxupquote{onErrorX}}，当用户登录失败时触发。错误码参考： 错误码

\end{itemize}


\paragraph{示例}
\label{\detokenize{csharp_activex:id16}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit13}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{登录}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Login()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{o}{/}\PYG{o}{/}\PYG{n}{登录方法}
\PYG{n}{function} \PYG{n}{Login}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Login}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{13800000009}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onOnlineStatusChangedX(message)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onOnlineStatusChangedX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{message}\PYG{p}{)}\PYG{p}{;}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{message为3表示登录成功}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{message} \PYG{o}{==} \PYG{l+m+mi}{3}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{window}\PYG{o}{.}\PYG{n}{location}\PYG{o}{.}\PYG{n}{href} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WebForm2.aspx}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onErrorX(message,error)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onErrorX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{message} \PYG{o}{+} \PYG{n}{error}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{Logout方法()}
\label{\detokenize{csharp_activex:logout}}
退出登录界面


\paragraph{语法}
\label{\detokenize{csharp_activex:id17}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Logout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id18}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit13}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{退出}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Logout()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{Logout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Logout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetCurrentUser方法()}
\label{\detokenize{csharp_activex:getcurrentuser}}
获取用户信息


\paragraph{语法}
\label{\detokenize{csharp_activex:id19}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetCurrentUser}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

返回值

Type: System.String

序列化的 JSON 字符串。

对象：用户实体类 User 参考 ：用户信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id20}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit37}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{获取当前登录的账号信息}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetCurrentUser()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{GetCurrentUser}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetCurrentUser}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enabled}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号09}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{GetOnlineStatus方法()}
\label{\detokenize{csharp_activex:getonlinestatus}}
获取当前用户在线状态


\paragraph{语法}
\label{\detokenize{csharp_activex:id21}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{OnlineStatus} \PYG{n}{GetOnlineStatus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type：OnlineStatus

返回在线状态的枚举，参考： 用户在线状态


\paragraph{示例}
\label{\detokenize{csharp_activex:id22}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit34}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{获取在线状态}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetOnlineStatus()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{GetOnlineStatus}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
     \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetOnlineStatus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetUid方法()}
\label{\detokenize{csharp_activex:getuid}}
获取当前账号UID


\paragraph{语法}
\label{\detokenize{csharp_activex:id23}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{GetUid}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

返回当前登录用户的UID

​


\paragraph{示例}
\label{\detokenize{csharp_activex:id24}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit35}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{获取账号ID}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetUid()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{GetUid}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
   \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetUid}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
 \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetName方法()}
\label{\detokenize{csharp_activex:getname}}
获取用户名


\paragraph{语法}
\label{\detokenize{csharp_activex:id25}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Sting

返回当前登录用户的中文名


\paragraph{示例}
\label{\detokenize{csharp_activex:id26}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit36}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{获取中文名}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetName()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{GetName}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetName}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
 \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{HasAudioEnabled方法()}
\label{\detokenize{csharp_activex:hasaudioenabled}}
是否被禁言状态


\paragraph{语法}
\label{\detokenize{csharp_activex:id27}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{HasAudioEnabled}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type：System.Boolean

true：正常发言 ，false：被禁言。

​


\paragraph{示例}
\label{\detokenize{csharp_activex:id28}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit36}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{是否被禁言}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HasAudioEnabled()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{HasAudioEnabled}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{HasAudioEnabled}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{ChangeName方法 (string)}
\label{\detokenize{csharp_activex:changename-string}}
修改用户名


\paragraph{语法}
\label{\detokenize{csharp_activex:id29}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ChangeName}\PYG{p}{(}\PYG{n}{string} \PYG{n}{name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

name

​ Type:System.String

​ 登录账号

​


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
参数
&\sphinxstyletheadfamily 
描述
&\sphinxstyletheadfamily 
备注
\\
\hline
name
&
新用户名称
&\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败

​


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id30}}\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{onChangeNameResultX}} 修改用户名触发此事件，事件处理是否修改成功。

\end{itemize}


\paragraph{示例}
\label{\detokenize{csharp_activex:id31}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit18}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{修改用户名}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ChangeName()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{ChangeName}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{ChangeName}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号09}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onChangeNameResultX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号名称修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号名称修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{ChangePassword方法(String,String)}
\label{\detokenize{csharp_activex:changepassword-string-string}}
修改密码


\paragraph{语法}
\label{\detokenize{csharp_activex:id32}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ChangePassword}\PYG{p}{(}\PYG{n}{string} \PYG{n}{oldpassword}\PYG{p}{,} \PYG{n}{string} \PYG{n}{newpassword}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

oldpassword

​ Type:System.String

​ 旧密码（明文）

newpassword

​ Type:System.String

​ 新密码（明文）

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id33}}\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{onChangePasswordResultX}} ,
修改密码触发此事件，事件处理是否修改成功

\end{itemize}


\paragraph{示例}
\label{\detokenize{csharp_activex:id34}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit19}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ChangePassword}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ChangePassword()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{ChangePassword}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{ChangePassword}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onChangePasswordResultX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号密码修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号密码修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{SaveAccount方法(String)}
\label{\detokenize{csharp_activex:saveaccount-string}}
保存账号


\paragraph{语法}
\label{\detokenize{csharp_activex:id35}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SaveAccount}\PYG{p}{(}\PYG{n}{string} \PYG{n}{account}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

account

​ Type: System.String

​ 序列化的 JSON 字符串。

​ 对象：用户实体类 User 参考 用户信息

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id36}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit14}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{保存账号}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SaveAccount()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{SaveAccount}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{obj} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Object}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
        \PYG{n}{obj}\PYG{o}{.}\PYG{n}{Name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{13800000009}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
        \PYG{n}{obj}\PYG{o}{.}\PYG{n}{Password} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
        \PYG{n}{obj}\PYG{o}{.}\PYG{n}{Role} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{;}
        \PYG{n}{obj}\PYG{o}{.}\PYG{n}{IsRemembered} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
        \PYG{n}{obj}\PYG{o}{.}\PYG{n}{IsAutoLogin} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}

        \PYG{n}{var} \PYG{n}{jsonStr} \PYG{o}{=} \PYG{n}{JSON}\PYG{o}{.}\PYG{n}{stringify}\PYG{p}{(}\PYG{n}{obj}\PYG{p}{)}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{SaveAccount}\PYG{p}{(}\PYG{n}{jsonStr}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{ClearAccount方法()}
\label{\detokenize{csharp_activex:clearaccount}}
清空已保存账号


\paragraph{语法}
\label{\detokenize{csharp_activex:id37}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ClearAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id38}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit44}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ClearAccount}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ClearAccount()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{ClearAccount}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{ClearAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{HasAccount方法()}
\label{\detokenize{csharp_activex:hasaccount}}
是否已保存账号


\paragraph{语法}
\label{\detokenize{csharp_activex:id39}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{HasAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type：System.Boolean

true：有 ，false：无


\paragraph{示例}
\label{\detokenize{csharp_activex:id40}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit15}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{HasAccount}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HasAccount()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{HasAccount}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
  \PYG{n}{var} \PYG{n}{result} \PYG{o}{=} \PYG{n}{actx}\PYG{o}{.}\PYG{n}{HasAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{result}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{有保存的账号}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{没有保存的账号}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetSavedAccount方法()}
\label{\detokenize{csharp_activex:getsavedaccount}}
获取已保存的账号


\paragraph{语法}
\label{\detokenize{csharp_activex:id41}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetSavedAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type: System.String

序列化的 JSON 字符串。

对象：账号实体类 Account参考 账号信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id42}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit17}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{获取已保存的账号}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetSavedAccount()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{GetSavedAccount}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetSavedAccount}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回值示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZdq{}Name\PYGZdq{}:\PYGZdq{}13800000009\PYGZdq{},\PYGZdq{}Password\PYGZdq{}:\PYGZdq{}1\PYGZdq{},\PYGZdq{}Role\PYGZdq{}:3,\PYGZdq{}IsRemembered\PYGZdq{}:0,\PYGZdq{}IsAutoLogin\PYGZdq{}：0\PYGZcb{}
\end{sphinxVerbatim}


\subsubsection{LoginWithSaved方法()}
\label{\detokenize{csharp_activex:loginwithsaved}}
使用已存储的账号登录


\paragraph{语法}
\label{\detokenize{csharp_activex:id43}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{LoginWithSaved}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id44}}\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{onOnlineStatusChangedX}} ，当用户登录成功后触发，\sphinxcode{\sphinxupquote{OnlineStatus}}
状态改为 \sphinxcode{\sphinxupquote{ONLINE\_STATUS\_ONLINE}}

\item {} 
\sphinxcode{\sphinxupquote{OnErrorX}}，当用户登录失败时触发。

\end{itemize}


\paragraph{示例}
\label{\detokenize{csharp_activex:id45}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit16}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LoginWithSaved}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{LoginWithSaved()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{n}{function} \PYG{n}{LoginWithSaved}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{LoginWithSaved}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{onOnlineStatusChangedX事件}
\label{\detokenize{csharp_activex:ononlinestatuschangedx}}
登录状态改变通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id46}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onOnlineStatusChangedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{OnlineStatus}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

status

​ Type: System.Object 用户在线状态

​ OnlineStatus 参考： 用户在线状态


\paragraph{示例}
\label{\detokenize{csharp_activex:id47}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onOnlineStatusChangedX(message)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{message} \PYG{o}{==} \PYG{n}{OnlineStatus}\PYG{o}{.}\PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{n}{此为用户在线状态}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{onChangeNameResultX事件}
\label{\detokenize{csharp_activex:onchangenameresultx}}
修改用户名称通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id48}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onChangeNameResultX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

success

​ Type: System.Object 修改名称结果

​ true：修改成功 false：修改失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id49}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onChangeNameResultX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
\PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号名称修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号名称修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{onChangePasswordResultX事件}
\label{\detokenize{csharp_activex:onchangepasswordresultx}}
修改密码通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id50}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onChangePasswordResultX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

​ 参数

success

​ Type: System.Object 修改密码结果

​ true：修改成功 false：修改失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id51}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onChangePasswordResultX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号密码修改成功}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
  \PYG{o}{/}\PYG{o}{/}\PYG{n}{账号密码修改失败}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{onAudioEnableChangedX事件}
\label{\detokenize{csharp_activex:onaudioenablechangedx}}
当前用户遥开遥闭状态通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id52}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onAudioEnableChangedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{audio\PYGZus{}enable}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

audio\_enable

​ Type: System.Object

​ true：遥开 false：遥闭


\paragraph{示例}
\label{\detokenize{csharp_activex:id53}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onAudioEnableChangedX(audio\PYGZus{}enable)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
  \PYG{k}{if}\PYG{p}{(}\PYG{n}{audio\PYGZus{}enable}\PYG{p}{)}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{遥开}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{遥闭}
  \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{onUserChangedX事件}
\label{\detokenize{csharp_activex:onuserchangedx}}
注册监听用户状态变化
\begin{itemize}
\item {} 
被动触发条件

\end{itemize}

echat 服务内部 User 缓存变更时触发，例如用户状态改变或用户名改变。

当前用户所在群组里的其他用户正在讲话时


\paragraph{语法}
\label{\detokenize{csharp_activex:id54}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onUserChangedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{count}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{usersListjson}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

count

​ Type: System.Object 变化用户数

​ usersListjson：

​ Type：System.String

​ 序列化的 JSON 字符串。

​ 对象：用户实体类 User 参考 ：用户信息

​


\paragraph{示例}
\label{\detokenize{csharp_activex:id55}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onUserChangedX(count,usersListjson)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
usersListjson数据：
[\PYGZob{}\PYGZdq{}gid\PYGZdq{}:600901,\PYGZdq{}uid\PYGZdq{}:50711,\PYGZdq{}role\PYGZdq{}:0,\PYGZdq{}online\PYGZdq{}:1,\PYGZdq{}has\PYGZus{}gid\PYGZdq{}:1,\PYGZdq{}has\PYGZus{}role\PYGZdq{}:1,\PYGZdq{}audio\PYGZus{}enable\PYGZdq{}:1,\PYGZdq{}name\PYGZdq{}:\PYGZdq{}账号01\PYGZdq{}\PYGZcb{}]
\end{sphinxVerbatim}


\subsection{群组}
\label{\detokenize{csharp_activex:id56}}

\subsubsection{JoinGroup方法(Int)}
\label{\detokenize{csharp_activex:joingroup-int}}
根据群组ID，进入到相应的群组里


\paragraph{语法}
\label{\detokenize{csharp_activex:id57}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{JoinGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id58}}
见 通知事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id59}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit22}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{JoinGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{JoinGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{JoinGroup}\PYG{p}{(}\PYG{p}{)}
    \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{JoinGroup}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{LeaveGroup方法()}
\label{\detokenize{csharp_activex:leavegroup}}
用户离开当前所在群组


\paragraph{语法}
\label{\detokenize{csharp_activex:id60}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{LeaveGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id61}}
见 通知事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id62}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit23}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LeaveGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{LeaveGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{LeaveGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{LeaveGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{Call方法(Array)}
\label{\detokenize{csharp_activex:call-array}}
创建临时群组


\paragraph{语法}
\label{\detokenize{csharp_activex:id63}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public int Call(Array uids)；
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，用户ID

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id64}}
见 通知事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id65}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit7}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Call}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Call()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
  \PYG{n}{function} \PYG{n}{Call}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
    \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
    \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}

    \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Call}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{销毁临时群组}
\label{\detokenize{csharp_activex:id66}}
临时群组创建者退出临时群组即为销毁临时群组。


\subsubsection{GetGroupList方法()}
\label{\detokenize{csharp_activex:getgrouplist}}
获取当前登录的调度员所在集团的所有群组列表


\paragraph{语法}
\label{\detokenize{csharp_activex:id67}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetGroupList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type: System.String

序列化的 JSON 字符串。

对象：群组实体类 Group参考：群组信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id68}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetGroupList}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetGroupList()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetGroupList}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetGroupList}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回值示例


\subsubsection{GetGroupByGid方法(int )}
\label{\detokenize{csharp_activex:getgroupbygid-int}}
根据GID 查询群组信息


\paragraph{语法}
\label{\detokenize{csharp_activex:id69}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetGroupByGid}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

返回值

Type: System.String

序列化的 JSON 字符串。

对象：群组实体类 Group参考：群组信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id70}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetGroupByGid}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetGroupByGid()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetGroupByGid}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetGroupByGid}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回值示例：


\subsubsection{GetCurrentGroup()}
\label{\detokenize{csharp_activex:getcurrentgroup}}
获取用户当前所在的群组ID


\paragraph{语法}
\label{\detokenize{csharp_activex:id71}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{GetCurrentGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

群组ID


\paragraph{示例}
\label{\detokenize{csharp_activex:id72}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetCurrentGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetCurrentGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetCurrentGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetCurrentGroup}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetMemberList(Int)}
\label{\detokenize{csharp_activex:getmemberlist-int}}
获取成员列表


\paragraph{语法}
\label{\detokenize{csharp_activex:id73}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetMemberList}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

返回值

Type: System.String

序列化的 JSON 字符串。

对象：成员实体类Member参考：成员信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id74}}
代码示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetMemberList}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetMemberList()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
     \PYG{n}{function} \PYG{n}{GetMemberList}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetMemberList}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回值示例：


\subsubsection{StartWatchGroup(Int)}
\label{\detokenize{csharp_activex:startwatchgroup-int}}
监听群组


\paragraph{语法}
\label{\detokenize{csharp_activex:id75}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartWatchGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id76}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StartWatchGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StartWatchGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{StartWatchGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StartWatchGroup}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

​


\subsubsection{StopWatchGroup(Int)}
\label{\detokenize{csharp_activex:stopwatchgroup-int}}
取消监听群组


\paragraph{语法}
\label{\detokenize{csharp_activex:id77}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{String} \PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

返回值

Type: System.String

序列化的 JSON 字符串。

对象：群组实体类Group参考：群组信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id78}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StopWatchGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StopWatchGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
     \PYG{n}{function} \PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StopWatchGroup}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{)}\PYG{p}{;}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onCurrentGroupX事件



当前所在群组变化通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id79}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onCurrentGroupX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

​ gid

​ Type: System.Object

​ 群组ID

group\_name

​ Type: System.Object

​ 群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id80}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onCurrentGroupX(gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onCurrentGroupX:gid }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{更新成员列表}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onMemberChangedX事件



群组成员发生变化通知
\begin{itemize}
\item {} 
被动触发条件

\end{itemize}

​ 其他成员进入所在的组时

​ 其他成员在自身所在的组下线时

​ 切换群组时
\begin{itemize}
\item {} 
主动触发

\end{itemize}

​ 进组

​ 离开群组

​ 创建临时组


\paragraph{语法}
\label{\detokenize{csharp_activex:id81}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onMemberChangedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{value}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

value

​ Type：System.String

​ 序列化的 JSON 字符串。

​ 对象：群组成员变化实体类 MemberChanged 参考 ： 群组成员变化


\paragraph{示例}
\label{\detokenize{csharp_activex:id82}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onMemberChangedX(val)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onMemberChangedX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{val}\PYG{p}{)}\PYG{p}{;}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onMemberListX事件



成员列表获取完毕


\paragraph{语法}
\label{\detokenize{csharp_activex:id83}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onMemberListX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

​ gid

​ Type: System.Object

​ 群组ID


\paragraph{示例}
\label{\detokenize{csharp_activex:id84}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onMemberListX(gid)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onMemberListX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{p}{)}\PYG{p}{;}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{更新成员列表}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onGroupListX事件



群组列表发生变化通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id85}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onGroupListX}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{示例}
\label{\detokenize{csharp_activex:id86}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onGroupListX()}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onGroupListX}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
     \PYG{o}{/}\PYG{o}{/} \PYG{n}{刷新群组列表}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsection{对讲}
\label{\detokenize{csharp_activex:id87}}

\subsubsection{StartSpeak方法()}
\label{\detokenize{csharp_activex:startspeak}}
抢麦 - 获取话权


\paragraph{语法}
\label{\detokenize{csharp_activex:id88}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id89}}
见 onStartSpeakX事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id90}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StartSpeak}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StartSpeak()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{StartSpeak}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StartSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{StopSpeak方法()}
\label{\detokenize{csharp_activex:stopspeak}}
放麦 - 释放话权


\paragraph{语法}
\label{\detokenize{csharp_activex:id91}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public int StopSpeak()；
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id92}}
见 onStopSpeakX事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id93}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StopSpeak}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StopSpeak()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{StopSpeak}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StopSpeak}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetPlayingSoundUser方法()}
\label{\detokenize{csharp_activex:getplayingsounduser}}
获取正在播放声音的人的user信息


\paragraph{语法}
\label{\detokenize{csharp_activex:id94}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public string GetPlayingSoundUser()；
\end{sphinxVerbatim}

返回值

Type: System.String

序列化的 JSON 字符串。

对象：用户实体类User参考：用户信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id95}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetPlayingSoundUser}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetPlayingSoundUser()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetPlayingSoundUser}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetPlayingSoundUser}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例：

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{600901}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{50711}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{GetSpeakingUsers方法()}
\label{\detokenize{csharp_activex:getspeakingusers}}
获取正在讲话的人的user信息（不一定是正在播放的，对于多群组而言)


\paragraph{语法}
\label{\detokenize{csharp_activex:id96}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetSpeakingUsers}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type: System.String

序列化的 JSON 字符串。

对象：用户实体类User集合参考：用户信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id97}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetSpeakingUsers}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetSpeakingUsers()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{GetSpeakingUsers}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetSpeakingUsers}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{600901}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{50711}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{600901}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{50712}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号02}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}
\end{sphinxVerbatim}


\subsubsection{IsSpeaking方法()}
\label{\detokenize{csharp_activex:isspeaking}}
自己当前是否正在讲话


\paragraph{语法}
\label{\detokenize{csharp_activex:id98}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{IsSpeaking}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Boolean

成功标示 true：在说话 ，false：没有说话


\paragraph{示例}
\label{\detokenize{csharp_activex:id99}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IsSpeaking}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{IsSpeaking()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{IsSpeaking}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
      \PYG{n}{var} \PYG{n}{result} \PYG{o}{=} \PYG{n}{actx}\PYG{o}{.}\PYG{n}{IsSpeaking}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
     \PYG{k}{if}\PYG{p}{(}\PYG{n}{result}\PYG{p}{)}\PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{n}{正在讲话}
     \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{n}{没有讲话}
     \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{IsListening()}
\label{\detokenize{csharp_activex:islistening}}
自己当前是否正收听语音


\paragraph{语法}
\label{\detokenize{csharp_activex:id100}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{IsListening}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

返回值

Type:System.Boolean

成功标示 true：在说话 ，false：没有说话


\paragraph{示例}
\label{\detokenize{csharp_activex:id101}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IsListening}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{IsListening()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{IsListening}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
      \PYG{n}{var} \PYG{n}{result} \PYG{o}{=} \PYG{n}{actx}\PYG{o}{.}\PYG{n}{IsListening}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
     \PYG{k}{if}\PYG{p}{(}\PYG{n}{result}\PYG{p}{)}\PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{n}{正在讲话}
     \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{n}{没有讲话}
     \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onStartSpeakX事件



抢麦通知
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 调用StartSpeak()方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id102}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStartSpeakX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type: System.Object

​ 当前讲话者所在的群组ID

group\_name

​ Type: System.Object

​ 当前讲话者所在的群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id103}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStartSpeakX(gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStartSpeakX  gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onStopSpeakX事件



放麦通知
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 调用StopSpeak()方法
\begin{itemize}
\item {} 
被动触发事件

\end{itemize}

​ 讲话超时被摘麦


\paragraph{语法}
\label{\detokenize{csharp_activex:id104}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStopSpeakX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

gid

​ Type: System.Object

​ 当前讲话者所在的群组ID

group\_name

​ Type: System.Object

​ 当前讲话者所在的群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id105}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStopSpeakX(gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStopSpeakX gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onStartPlayingX事件



开始播放讲话者事件通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id106}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStartPlayingX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

uid

​ Type: System.Object

​ 讲话者ID

name

​ Type: System.Object

​ 讲话者名称

gid

​ Type: System.Object

​ 群组ID

group\_name

​ Type: System.Object

​ 群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id107}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStartPlayingX(uid,name,gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStartPlayingX  uid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{uid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{name} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onStopPlayingX事件



停止播放讲话者事件通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id108}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStopPlayingX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

uid

​ Type: System.Object

​ 讲话者ID

name

​ Type: System.Object

​ 讲话者名称

gid

​ Type: System.Object

​ 群组ID

group\_name

​ Type: System.Object

​ 群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id109}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStopPlayingX(uid,name,gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStopPlayingX uid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{uid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{name} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onUserStartSpeakX事件



调度员所在群组里，其他成员抢麦成功事件通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id110}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onUserStartSpeakX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

uid

​ Type: System.Object

​ 讲话者ID

name

​ Type: System.Object

​ 讲话者名称

gid

​ Type: System.Object

​ 群组ID

group\_name

​ Type: System.Object

​ 群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id111}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onUserStartSpeakX(uid,name,gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onUserStartSpeakX uid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{uid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{name} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onUserStopSpeakX事件



调度员所在群组里，其他成员放麦事件通知


\paragraph{语法}
\label{\detokenize{csharp_activex:id112}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onUserStopSpeakX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{name}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

uid

​ Type: System.Object

​ 讲话者ID

name

​ Type: System.Object

​ 讲话者名称

gid

​ Type: System.Object

​ 群组ID

group\_name

​ Type: System.Object

​ 群组名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id113}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onUserStopSpeakX(uid,name,gid,group\PYGZus{}name)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onUserStopSpeakX uid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{uid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{name} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  gid:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{gid} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  group\PYGZus{}name:}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{group\PYGZus{}name}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsection{广播}
\label{\detokenize{csharp_activex:id114}}

\subsubsection{SendTextBroadcast方法(string , Array)}
\label{\detokenize{csharp_activex:sendtextbroadcast-string-array}}
发送文字广播


\paragraph{语法}
\label{\detokenize{csharp_activex:id115}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SendTextBroadcast}\PYG{p}{(}\PYG{n}{string} \PYG{n}{text}\PYG{p}{,} \PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

text

​ Type:System.String

​ 文字信息（文字长度1-40个字符）

uids

​ Type:System.Array

​ 一维Array，收听广播的用户ID集合

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id116}}
见 onSendedX事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id117}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SendTextBroadcast}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SendTextBroadcast()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{SendTextBroadcast}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{SendTextBroadcast}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{文字广播测试}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{StartRecordBroadcastAudio方法()}
\label{\detokenize{csharp_activex:startrecordbroadcastaudio}}
开始录制音频文件


\paragraph{语法}
\label{\detokenize{csharp_activex:id118}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StartRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id119}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StartRecordBroadcastAudio}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StartRecordBroadcastAudio()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{StartRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StartRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{StopRecordBroadcastAudio方法()}
\label{\detokenize{csharp_activex:stoprecordbroadcastaudio}}
停止录制音频文件


\paragraph{语法}
\label{\detokenize{csharp_activex:id120}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{StopRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id121}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{StopRecordBroadcastAudio}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{StopRecordBroadcastAudio()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{StopRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{StopRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{SendAudioBroadcast(Array)}
\label{\detokenize{csharp_activex:sendaudiobroadcast-array}}
发送语音广播


\paragraph{语法}
\label{\detokenize{csharp_activex:id122}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{SendAudioBroadcast}\PYG{p}{(}\PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，收听广播的用户ID集合

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id123}}
见 onSendedX事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id124}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SendAudioBroadcast}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SendAudioBroadcast()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{SendAudioBroadcast}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
       \PYG{n}{actx}\PYG{o}{.}\PYG{n}{SendAudioBroadcast}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{PlayRecordBroadcastAudio方法()}
\label{\detokenize{csharp_activex:playrecordbroadcastaudio}}
播放已录制的待播放音频文件


\paragraph{语法}
\label{\detokenize{csharp_activex:id125}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{PlayRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{通知事件}
\label{\detokenize{csharp_activex:id126}}
见 OnPlayStopX事件


\paragraph{示例}
\label{\detokenize{csharp_activex:id127}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PlayRecordBroadcastAudio}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PlayRecordBroadcastAudio()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{PlayRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{PlayRecordBroadcastAudio}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onSendedX事件



发送广播结果响应事件
\begin{itemize}
\item {} 
主动触发条件 执行 SendAudioBroadcast 方法

\end{itemize}

执行SendTextBroadcast方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id128}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onSendedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

success：

​ Type:System.Object

​ ture:发送成功 false:发送失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id129}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onSendedX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onSendedX  }\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{success}\PYG{p}{)} \PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/}\PYG{n}{发送成功}
    \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
      \PYG{o}{/}\PYG{o}{/}\PYG{n}{发送失败}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




OnPlayStopX事件



录音结束回调
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 执行 PlayRecordBroadcastAudio 方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id130}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{OnPlayStopX}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{示例}
\label{\detokenize{csharp_activex:id131}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{OnPlayStopX()}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{n}{调用发送广播方法}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsection{调度}
\label{\detokenize{csharp_activex:id132}}

\subsubsection{TempJoinGroup方法(Int,Array)}
\label{\detokenize{csharp_activex:tempjoingroup-int-array}}
将在线的用户临时加入到指定的群组中


\paragraph{语法}
\label{\detokenize{csharp_activex:id133}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{TempJoinGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

uids

​ Type:System.Array

​ 一维Array，用户ID集合

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id134}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TempJoinGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{TempJoinGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{TempJoinGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{TempJoinGroup}\PYG{p}{(}\PYG{l+m+mi}{600901}\PYG{p}{,} \PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{TempLeaveGroup(Int, Array)}
\label{\detokenize{csharp_activex:templeavegroup-int-array}}
临时移出组


\paragraph{语法}
\label{\detokenize{csharp_activex:id135}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{TempLeaveGroup}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{gid}\PYG{p}{,} \PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

gid

​ Type:System.Int32

​ 群组ID

uids

​ Type:System.Array

​ 一维Array，用户ID集合

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id136}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TempLeaveGroup}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{TempLeaveGroup()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{TempLeaveGroup}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{TempLeaveGroup}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{Audioenable方法(Array, bool)}
\label{\detokenize{csharp_activex:audioenable-array-bool}}
遥开遥闭


\paragraph{语法}
\label{\detokenize{csharp_activex:id137}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Audioenable}\PYG{p}{(}\PYG{n}{Array} \PYG{n}{uids}\PYG{p}{,} \PYG{n+nb}{bool} \PYG{n}{audioenabled}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，用户ID集合

audioenabled

​ Type:System.Boolean

​ true:遥开 false:遥闭

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id138}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{遥开}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Audioenable()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{Audioenable}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{Audioenable}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{,}\PYG{n}{true}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{ForceDispatch方法(Array)}
\label{\detokenize{csharp_activex:forcedispatch-array}}
强拉，在群组列表中把在线不在本群组内的人员强拉回调度员所在群组


\paragraph{语法}
\label{\detokenize{csharp_activex:id139}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ForceDispatch}\PYG{p}{(}\PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，用户ID集合

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id140}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ForceDispatch}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ForceDispatch()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{function} \PYG{n}{ForceDispatch}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
       \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{ForceDispatch}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{Takemic方法(Array)}
\label{\detokenize{csharp_activex:takemic-array}}
强拆，在群组列表中把正在讲话的用户强拆，强制中断其语音


\paragraph{语法}
\label{\detokenize{csharp_activex:id141}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Takemic}\PYG{p}{(}\PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，用户ID集合

返回值

Type:System.Int32

执行成功标示：0【成功】 -1【失败】


\paragraph{示例}
\label{\detokenize{csharp_activex:id142}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Takemic}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Takemic()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{Takemic}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
      \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{alert}\PYG{p}{(}\PYG{n}{actx}\PYG{o}{.}\PYG{n}{Takemic}\PYG{p}{(}\PYG{n}{mycars}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsubsection{GetUser方法(int)}
\label{\detokenize{csharp_activex:getuser-int}}
获取用户信息


\paragraph{语法}
\label{\detokenize{csharp_activex:id143}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetUser}\PYG{p}{(}\PYG{n+nb}{int} \PYG{n}{uid}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uid

​ Type:System.Int32

​ 用户ID

返回值

Type: System.String

序列化的 JSON 字符串。

对象：用户实体类User参考：用户信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id144}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetUser}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetUser()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetUser}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetUser}\PYG{p}{(}\PYG{l+m+mi}{50711}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{600901}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{50711}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsubsection{GetUsers方法(Array)}
\label{\detokenize{csharp_activex:getusers-array}}
获取用户信息集合


\paragraph{语法}
\label{\detokenize{csharp_activex:id145}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{string} \PYG{n}{GetUser}\PYG{p}{(}\PYG{n}{Array} \PYG{n}{uids}\PYG{p}{)}
\end{sphinxVerbatim}

参数

uids

​ Type:System.Array

​ 一维Array，用户ID集合

返回值

Type: System.String

序列化的 JSON 字符串。

对象：用户实体类User集合参考：用户信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id146}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZlt{}}\PYG{n+nb}{input} \PYG{n+nb}{id}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Submit20}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{submit}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{value}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GetUsers}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{runat}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server}\PYG{l+s+s2}{\PYGZdq{}}  \PYG{n}{onclick}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GetUsers()}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{/}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
   \PYG{n}{function} \PYG{n}{GetUsers}\PYG{p}{(}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{var} \PYG{n}{uids} \PYG{o}{=} \PYG{n}{new} \PYG{n}{Array}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{uids}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{50720}\PYG{p}{;}
        \PYG{n}{actx}\PYG{o}{.}\PYG{n}{GetUsers}\PYG{p}{(}\PYG{n}{uids}\PYG{p}{)}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

返回数据示例

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{600901}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{50711}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{online}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}gid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{has\PYGZus{}role}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{audio\PYGZus{}enable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{账号01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onDispatchedX事件



强拉结果通知事件
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 执行ForceDispatch 方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id147}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onDispatchedX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{usersListjson}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

usersListjson

Type: System.Object

序列化的 JSON 字符串。

对象：Dispatched 参考 ： 强拉信息


\paragraph{示例}
\label{\detokenize{csharp_activex:id148}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onDispatchedX(usersListjson)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onDispatchedX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{usersListjson}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onTakeMicX事件



强拆结果通知事件
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 执行 Takemic 方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id149}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onTakeMicX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

success

​ Type: System.Object

​ true：成功 false：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id150}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onTakeMicX(success)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onTakeMicX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{success}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\bigskip\hrule\bigskip




onAudioEnabledX事件



遥开遥闭结果通知事件
\begin{itemize}
\item {} 
主动触发条件

\end{itemize}

​ 执行 Audioenable方法


\paragraph{语法}
\label{\detokenize{csharp_activex:id151}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onAudioEnabledX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{usersListjson}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

usersListjson

Type: System.Object

序列化的 JSON 字符串。

对象： Andioenable 参考 ： 遥开遥闭


\paragraph{示例}
\label{\detokenize{csharp_activex:id152}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onAudioEnabledX(usersListjson)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}
    \PYG{n}{alert}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onAudioEnabledX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{n}{usersListjson}\PYG{p}{)}\PYG{p}{;}
\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\subsection{本地录音}
\label{\detokenize{csharp_activex:id153}}

\subsubsection{EnableLocalRecord方法(bool, string)}
\label{\detokenize{csharp_activex:enablelocalrecord-bool-string}}
设置本地录音


\paragraph{语法}
\label{\detokenize{csharp_activex:id154}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{EnableLocalRecord}\PYG{p}{(}\PYG{n+nb}{bool} \PYG{n}{enable}\PYG{p}{,} \PYG{n}{string} \PYG{n}{pathDir}\PYG{p}{)}
\end{sphinxVerbatim}

参数

enable

​ Type:System.Boolean

​ true:开启本地录音 false:关闭本地录音

pathDir

​ Type:System.String

​ 本地录音文件保存的路径

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id155}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYGZlt{}input id=\PYGZdq{}Submit20\PYGZdq{} type=\PYGZdq{}submit\PYGZdq{} value=\PYGZsq{}EnableLocalRecord\PYGZsq{} runat=\PYGZdq{}server\PYGZdq{}  onclick=\PYGZdq{}EnableLocalRecord()\PYGZdq{} /\PYGZgt{}

\PYGZlt{}script language=\PYGZdq{}javascript\PYGZdq{} type=\PYGZdq{}text/javascript\PYGZdq{}\PYGZgt{}
    function EnableLocalRecord() \PYGZob{}
        actx.EnableLocalRecord(true，\PYGZdq{}d:\PYGZbs{}\PYGZdq{});
    \PYGZcb{}
\PYGZlt{}/script\PYGZgt{}
\end{sphinxVerbatim}


\subsubsection{PlayLocalRecord方法(string)}
\label{\detokenize{csharp_activex:playlocalrecord-string}}
播放本地录音


\paragraph{语法}
\label{\detokenize{csharp_activex:id156}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{PlayLocalRecord}\PYG{p}{(}\PYG{n}{string} \PYG{n}{path}\PYG{p}{)}
\end{sphinxVerbatim}

参数

path

​ Type:System.String

​ 文件的绝对路径（播放的文件格式为evrc）

返回值

Type:System.Int32

执行成功标示 0：成功 ，-1：失败


\paragraph{示例}
\label{\detokenize{csharp_activex:id157}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}input id=\PYGZdq{}Submit20\PYGZdq{} type=\PYGZdq{}submit\PYGZdq{} value=\PYGZsq{}PlayLocalRecord\PYGZsq{} runat=\PYGZdq{}server\PYGZdq{}  onclick=\PYGZdq{}PlayLocalRecord()\PYGZdq{} /\PYGZgt{}

\PYGZlt{}script language=\PYGZdq{}javascript\PYGZdq{} type=\PYGZdq{}text/javascript\PYGZdq{}\PYGZgt{}
   function PlayLocalRecord() \PYGZob{}
        actx.PlayLocalRecord(true，\PYGZdq{}D:\PYGZbs{}2018\PYGZus{}1\PYGZus{}18\PYGZus{}13\PYGZus{}45\PYGZus{}4\PYGZus{}996\PYGZus{}600901\PYGZus{}50711.evrc\PYGZdq{});
    \PYGZcb{}
\PYGZlt{}/script\PYGZgt{}
\end{sphinxVerbatim}


\subsubsection{onStartRecordX事件}
\label{\detokenize{csharp_activex:onstartrecordx}}
开始录音的通知事件


\paragraph{语法}
\label{\detokenize{csharp_activex:id158}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStartRecordX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{starttime}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{filename}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\paragraph{示例}
\label{\detokenize{csharp_activex:id159}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStartRecordX(gid,uid,starttime,filename)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

参数

gid

​ Type: System.Object

​ 群组ID

uid

​ Type: System.Object

​ 讲话者ID

starttime

​ Type: System.Object

​ 开始录制时间

filename

​ Type: System.Object

​ 文件名称


\subsubsection{onStopRecordX事件}
\label{\detokenize{csharp_activex:onstoprecordx}}
结束录音的通知事件


\paragraph{语法}
\label{\detokenize{csharp_activex:id160}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{void} \PYG{n}{onStopRecordX}\PYG{p}{(}\PYG{n+nb}{object} \PYG{n}{success}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{gid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{uid}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{finishtime}\PYG{p}{,} \PYG{n+nb}{object} \PYG{n}{filename}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

参数

success

​ Type: System.Object

​ 执行结果true:成功 false:失败

gid

​ Type: System.Object

​ 群组ID

uid

​ Type: System.Object

​ 讲话者ID

finishtime

​ Type: System.Object

​ 结束录制时间

filename

​ Type: System.Object

​ 文件名称


\paragraph{示例}
\label{\detokenize{csharp_activex:id161}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZlt{}}\PYG{n}{script} \PYG{n}{language}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{for}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{myAcX}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/javascript}\PYG{l+s+s2}{\PYGZdq{}} \PYG{n}{event}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{onStopRecordX(success,gid,uid,finishtime,filename)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{\PYGZgt{}}

\PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{script}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}


\section{数据结构定义}
\label{\detokenize{csharp_activex:id162}}
\#\#\#



账号信息



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public struct Account
\PYGZob{}
       /// \PYGZlt{}summary\PYGZgt{}
       /// 登录名
       /// \PYGZlt{}/summary\PYGZgt{}
       public string Name

       /// \PYGZlt{}summary\PYGZgt{}
       /// 密码
       /// \PYGZlt{}/summary\PYGZgt{}
       public string Password

       /// \PYGZlt{}summary\PYGZgt{}
       /// 用户角色
       /// 0：对讲用户 3：调度员
       /// \PYGZlt{}/summary\PYGZgt{}
       public int Role

       /// \PYGZlt{}summary\PYGZgt{}
       /// 是否自动登录
       /// \PYGZlt{}/summary\PYGZgt{}
       public int IsAutoLogin

       /// \PYGZlt{}summary\PYGZgt{}
       /// 是否记住密码
       /// \PYGZlt{}/summary\PYGZgt{}
       public int IsRemembered
\PYGZcb{}
\end{sphinxVerbatim}

\#\#\#



群组信息



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 public struct Group
   \PYGZob{}
    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组类型：1为普通组，2为临时组，3为紧急组
    /// \PYGZlt{}/summary\PYGZgt{}
    public int type;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组编号
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt32 gid;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组名称
    /// \PYGZlt{}/summary\PYGZgt{}
    public string name;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 群组优先级
    /// \PYGZlt{}/summary\PYGZgt{}
    public int prior;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 服务IP
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt32 ip;

    /// \PYGZlt{}summary\PYGZgt{}
    /// 服务端口
    /// \PYGZlt{}/summary\PYGZgt{}
    public UInt16 port;
\PYGZcb{}
\end{sphinxVerbatim}

\#\#\#



用户信息



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
public struct User
\PYGZob{}
  /// \PYGZlt{}summary\PYGZgt{}
  /// 所在群组的编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public UInt32 gid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 用户编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public UInt32 uid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 用户角色 0：对讲用户 3：调度员
  /// \PYGZlt{}/summary\PYGZgt{}

  public UInt32 role;
  /// \PYGZlt{}summary\PYGZgt{}
  /// 在线状态
  /// \PYGZlt{}/summary\PYGZgt{}
  public int online;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 是否有群组编号
  /// \PYGZlt{}/summary\PYGZgt{}
  public int has\PYGZus{}gid;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 是否有角色
  /// \PYGZlt{}/summary\PYGZgt{}
  public int has\PYGZus{}role;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 语音状态是否打开
  /// \PYGZlt{}/summary\PYGZgt{}
  public int audio\PYGZus{}enabled;

  /// \PYGZlt{}summary\PYGZgt{}
  /// 成员名称
  /// \PYGZlt{}/summary\PYGZgt{}
  public string name;
\PYGZcb{}
\end{sphinxVerbatim}

\#\#\#



成员信息



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{struct} \PYG{n}{Member}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{所在群组的编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{gid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{uid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户角色}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{UInt32} \PYG{n}{role}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{在线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{online}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否再组}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{ingroup}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否有群组编号}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{has\PYGZus{}gid}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否有角色}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{has\PYGZus{}role}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{语音状态是否打开}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{audio\PYGZus{}enabled}\PYG{p}{;}

    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{成员名称}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{public} \PYG{n}{string} \PYG{n}{name}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\#\#\#



群组成员变化



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{k}{class} \PYG{n+nc}{MemberChanged}
   \PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{群组ID}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Gid}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{新加入当前群组人员id}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Us}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{新加入成员个数}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Uc}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/}\PYG{n}{退出当前群组人员id}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Rs}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{退出成员个数}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Rc}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{进入当前群组人员} \PYG{n+nb}{id}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Js}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{进入成员个数}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Jc}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{离开当前群组人员i}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Ls}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{离开成员个数}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Lc}\PYG{p}{;}
   \PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\#\#\#



强拉信息



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public}  \PYG{k}{class} \PYG{n+nc}{Dispatched}
   \PYG{p}{\PYGZob{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{执行结果}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{Success}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{是否有群组}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{HasGid}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{群组ID}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Gid}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户ID集合}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Uids}\PYG{p}{;}

       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户个数}
       \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
       \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{UidSize}\PYG{p}{;}
   \PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\#\#\#



遥开遥闭



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{k}{class} \PYG{n+nc}{AudioEnabled}
    \PYG{p}{\PYGZob{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{执行结果}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{Success}\PYG{p}{;}

        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{遥开遥闭状态}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{n}{public} \PYG{n+nb}{bool} \PYG{n}{AudioEnable}\PYG{p}{;}

        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户ID集合}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{n}{public} \PYG{n}{List}\PYG{o}{\PYGZlt{}}\PYG{n+nb}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{Uids}\PYG{p}{;}

        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{用户个数}
        \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
        \PYG{n}{public} \PYG{n+nb}{int} \PYG{n}{Size}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\section{数据定义}
\label{\detokenize{csharp_activex:id163}}
\#\#\#



错误码



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}1：帐号密码错误
\PYGZhy{}2：帐号已欠费或已超出服务期
\PYGZhy{}3：帐号不存在
\PYGZhy{}4：无效的帐号登录权限
\PYGZhy{}10：帐号已在其他位置登录
\PYGZhy{}11：帐号登录超时
\PYGZhy{}20：网络连接失败
\PYGZhy{}21：网络正在重连
\PYGZhy{}30：加入群组失败
\PYGZhy{}31：加入群组请求超时
\PYGZhy{}40:当前有人正在讲话\PYGZlt{}服务器回馈\PYGZgt{}
\PYGZhy{}41：短时间内不允许多次抢麦
\PYGZhy{}42：摇闭状态不允许抢麦
\PYGZhy{}43：内部会话状态错误\PYGZlt{}主动放麦后立马去抢麦\PYGZgt{}
\PYGZhy{}44：抢麦时申请音频焦点失败
\PYGZhy{}45：已较低的优先级抢麦\PYGZlt{}出现在当时正在有人讲话，自身比讲话人优先级低时\PYGZgt{}
\PYGZhy{}46：网络不稳定
\PYGZhy{}50：打开录音设备失败
\end{sphinxVerbatim}


\subsection{接口调用返回值}
\label{\detokenize{csharp_activex:id164}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}1：操作失败
 0：操作成功
\end{sphinxVerbatim}

\#\#\#



用户在线状态



\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{public} \PYG{n}{enum} \PYG{n}{OnlineStatus}
\PYG{p}{\PYGZob{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{未知状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}UNKNOWN} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{离线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}OFFLINE} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{登录中}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}LOGINING} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{,}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{n}{在线状态}
    \PYG{o}{/}\PYG{o}{/}\PYG{o}{/} \PYG{o}{\PYGZlt{}}\PYG{o}{/}\PYG{n}{summary}\PYG{o}{\PYGZgt{}}
    \PYG{n}{ONLINE\PYGZus{}STATUS\PYGZus{}ONLINE} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{索引}
\printindex
\end{document}